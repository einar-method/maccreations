(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const jt=(()=>{let n=!1;typeof window<"u"&&typeof window.localStorage<"u"?n=!!window.localStorage.getItem("loggingEnabled"):n=!1;function t(e){return(...r)=>{n&&console[e](...r)}}return{info:t("info"),debug:t("debug"),error:t("error")}})();function Lt(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ze={exports:{}};(function(n,t){(function(e){n.exports=e()})(function(){return function e(r,i,o){function u(c,d){if(!i[c]){if(!r[c]){var _=typeof Lt=="function"&&Lt;if(!d&&_)return _(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+c+"'")}d=i[c]={exports:{}},r[c][0].call(d.exports,function(U){var L=r[c][1][U];return u(L||U)},d,d.exports,e,r,i,o)}return i[c].exports}for(var a=typeof Lt=="function"&&Lt,h=0;h<o.length;h++)u(o[h]);return u}({1:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){var A=e("crypto");function x(v,S){S=C(v,S);var l;return(l=S.algorithm!=="passthrough"?A.createHash(S.algorithm):new R).write===void 0&&(l.write=l.update,l.end=l.update),j(S,l).dispatch(v),l.update||l.end(""),l.digest?l.digest(S.encoding==="buffer"?void 0:S.encoding):(v=l.read(),S.encoding!=="buffer"?v.toString(S.encoding):v)}(i=r.exports=x).sha1=function(v){return x(v)},i.keys=function(v){return x(v,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(v){return x(v,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(v){return x(v,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var w=A.getHashes?A.getHashes().slice():["sha1","md5"],k=(w.push("passthrough"),["buffer","hex","binary","base64"]);function C(v,S){var l={};if(l.algorithm=(S=S||{}).algorithm||"sha1",l.encoding=S.encoding||"hex",l.excludeValues=!!S.excludeValues,l.algorithm=l.algorithm.toLowerCase(),l.encoding=l.encoding.toLowerCase(),l.ignoreUnknown=S.ignoreUnknown===!0,l.respectType=S.respectType!==!1,l.respectFunctionNames=S.respectFunctionNames!==!1,l.respectFunctionProperties=S.respectFunctionProperties!==!1,l.unorderedArrays=S.unorderedArrays===!0,l.unorderedSets=S.unorderedSets!==!1,l.unorderedObjects=S.unorderedObjects!==!1,l.replacer=S.replacer||void 0,l.excludeKeys=S.excludeKeys||void 0,v===void 0)throw new Error("Object argument required.");for(var g=0;g<w.length;++g)w[g].toLowerCase()===l.algorithm.toLowerCase()&&(l.algorithm=w[g]);if(w.indexOf(l.algorithm)===-1)throw new Error('Algorithm "'+l.algorithm+'"  not supported. supported values: '+w.join(", "));if(k.indexOf(l.encoding)===-1&&l.algorithm!=="passthrough")throw new Error('Encoding "'+l.encoding+'"  not supported. supported values: '+k.join(", "));return l}function E(v){if(typeof v=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(v))!=null}function j(v,S,l){l=l||[];function g(f){return S.update?S.update(f,"utf8"):S.write(f,"utf8")}return{dispatch:function(f){return this["_"+((f=v.replacer?v.replacer(f):f)===null?"null":typeof f)](f)},_object:function(f){var b,m=Object.prototype.toString.call(f),D=/\[object (.*)\]/i.exec(m);if(D=(D=D?D[1]:"unknown:["+m+"]").toLowerCase(),0<=(m=l.indexOf(f)))return this.dispatch("[CIRCULAR:"+m+"]");if(l.push(f),a!==void 0&&a.isBuffer&&a.isBuffer(f))return g("buffer:"),g(f);if(D==="object"||D==="function"||D==="asyncfunction")return m=Object.keys(f),v.unorderedObjects&&(m=m.sort()),v.respectType===!1||E(f)||m.splice(0,0,"prototype","__proto__","constructor"),v.excludeKeys&&(m=m.filter(function(B){return!v.excludeKeys(B)})),g("object:"+m.length+":"),b=this,m.forEach(function(B){b.dispatch(B),g(":"),v.excludeValues||b.dispatch(f[B]),g(",")});if(!this["_"+D]){if(v.ignoreUnknown)return g("["+D+"]");throw new Error('Unknown object type "'+D+'"')}this["_"+D](f)},_array:function(f,B){B=B!==void 0?B:v.unorderedArrays!==!1;var m=this;if(g("array:"+f.length+":"),!B||f.length<=1)return f.forEach(function(N){return m.dispatch(N)});var D=[],B=f.map(function(N){var M=new R,F=l.slice();return j(v,M,F).dispatch(N),D=D.concat(F.slice(l.length)),M.read().toString()});return l=l.concat(D),B.sort(),this._array(B,!1)},_date:function(f){return g("date:"+f.toJSON())},_symbol:function(f){return g("symbol:"+f.toString())},_error:function(f){return g("error:"+f.toString())},_boolean:function(f){return g("bool:"+f.toString())},_string:function(f){g("string:"+f.length+":"),g(f.toString())},_function:function(f){g("fn:"),E(f)?this.dispatch("[native]"):this.dispatch(f.toString()),v.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(f.name)),v.respectFunctionProperties&&this._object(f)},_number:function(f){return g("number:"+f.toString())},_xml:function(f){return g("xml:"+f.toString())},_null:function(){return g("Null")},_undefined:function(){return g("Undefined")},_regexp:function(f){return g("regex:"+f.toString())},_uint8array:function(f){return g("uint8array:"),this.dispatch(Array.prototype.slice.call(f))},_uint8clampedarray:function(f){return g("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(f))},_int8array:function(f){return g("int8array:"),this.dispatch(Array.prototype.slice.call(f))},_uint16array:function(f){return g("uint16array:"),this.dispatch(Array.prototype.slice.call(f))},_int16array:function(f){return g("int16array:"),this.dispatch(Array.prototype.slice.call(f))},_uint32array:function(f){return g("uint32array:"),this.dispatch(Array.prototype.slice.call(f))},_int32array:function(f){return g("int32array:"),this.dispatch(Array.prototype.slice.call(f))},_float32array:function(f){return g("float32array:"),this.dispatch(Array.prototype.slice.call(f))},_float64array:function(f){return g("float64array:"),this.dispatch(Array.prototype.slice.call(f))},_arraybuffer:function(f){return g("arraybuffer:"),this.dispatch(new Uint8Array(f))},_url:function(f){return g("url:"+f.toString())},_map:function(f){return g("map:"),f=Array.from(f),this._array(f,v.unorderedSets!==!1)},_set:function(f){return g("set:"),f=Array.from(f),this._array(f,v.unorderedSets!==!1)},_file:function(f){return g("file:"),this.dispatch([f.name,f.size,f.type,f.lastModfied])},_blob:function(){if(v.ignoreUnknown)return g("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return g("domwindow")},_bigint:function(f){return g("bigint:"+f.toString())},_process:function(){return g("process")},_timer:function(){return g("timer")},_pipe:function(){return g("pipe")},_tcp:function(){return g("tcp")},_udp:function(){return g("udp")},_tty:function(){return g("tty")},_statwatcher:function(){return g("statwatcher")},_securecontext:function(){return g("securecontext")},_connection:function(){return g("connection")},_zlib:function(){return g("zlib")},_context:function(){return g("context")},_nodescript:function(){return g("nodescript")},_httpparser:function(){return g("httpparser")},_dataview:function(){return g("dataview")},_signal:function(){return g("signal")},_fsevent:function(){return g("fsevent")},_tlswrap:function(){return g("tlswrap")}}}function R(){return{buf:"",write:function(v){this.buf+=v},end:function(v){this.buf+=v},read:function(){return this.buf}}}i.writeToStream=function(v,S,l){return l===void 0&&(l=S,S={}),j(S=C(v,S),l).dispatch(v)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){(function(A){var x=typeof Uint8Array<"u"?Uint8Array:Array,w=43,k=47,C=48,E=97,j=65,R=45,v=95;function S(l){return l=l.charCodeAt(0),l===w||l===R?62:l===k||l===v?63:l<C?-1:l<C+10?l-C+26+26:l<j+26?l-j:l<E+26?l-E+26:void 0}A.toByteArray=function(l){var g,f;if(0<l.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var b=l.length,b=l.charAt(b-2)==="="?2:l.charAt(b-1)==="="?1:0,m=new x(3*l.length/4-b),D=0<b?l.length-4:l.length,B=0;function N(M){m[B++]=M}for(g=0;g<D;g+=4,0)N((16711680&(f=S(l.charAt(g))<<18|S(l.charAt(g+1))<<12|S(l.charAt(g+2))<<6|S(l.charAt(g+3))))>>16),N((65280&f)>>8),N(255&f);return b==2?N(255&(f=S(l.charAt(g))<<2|S(l.charAt(g+1))>>4)):b==1&&(N((f=S(l.charAt(g))<<10|S(l.charAt(g+1))<<4|S(l.charAt(g+2))>>2)>>8&255),N(255&f)),m},A.fromByteArray=function(l){var g,f,b,m,D=l.length%3,B="";function N(M){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(M)}for(g=0,b=l.length-D;g<b;g+=3)f=(l[g]<<16)+(l[g+1]<<8)+l[g+2],B+=N((m=f)>>18&63)+N(m>>12&63)+N(m>>6&63)+N(63&m);switch(D){case 1:B=(B+=N((f=l[l.length-1])>>2))+N(f<<4&63)+"==";break;case 2:B=(B=(B+=N((f=(l[l.length-2]<<8)+l[l.length-1])>>10))+N(f>>4&63))+N(f<<2&63)+"="}return B}})(i===void 0?this.base64js={}:i)}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(e,r,i){(function(o,u,w,h,c,d,_,U,L){var A=e("base64-js"),x=e("ieee754");function w(s,p,y){if(!(this instanceof w))return new w(s,p,y);var I,O,P,$,z=typeof s;if(p==="base64"&&z=="string")for(s=($=s).trim?$.trim():$.replace(/^\s+|\s+$/g,"");s.length%4!=0;)s+="=";if(z=="number")I=V(s);else if(z=="string")I=w.byteLength(s,p);else{if(z!="object")throw new Error("First argument needs to be a number, array or string.");I=V(s.length)}if(w._useTypedArrays?O=w._augment(new Uint8Array(I)):((O=this).length=I,O._isBuffer=!0),w._useTypedArrays&&typeof s.byteLength=="number")O._set(s);else if(J($=s)||w.isBuffer($)||$&&typeof $=="object"&&typeof $.length=="number")for(P=0;P<I;P++)w.isBuffer(s)?O[P]=s.readUInt8(P):O[P]=s[P];else if(z=="string")O.write(s,0,p);else if(z=="number"&&!w._useTypedArrays&&!y)for(P=0;P<I;P++)O[P]=0;return O}function k(s,p,y,I){return w._charsWritten=vt(function(O){for(var P=[],$=0;$<O.length;$++)P.push(255&O.charCodeAt($));return P}(p),s,y,I)}function C(s,p,y,I){return w._charsWritten=vt(function(O){for(var P,$,z=[],K=0;K<O.length;K++)$=O.charCodeAt(K),P=$>>8,$=$%256,z.push($),z.push(P);return z}(p),s,y,I)}function E(s,p,y){var I="";y=Math.min(s.length,y);for(var O=p;O<y;O++)I+=String.fromCharCode(s[O]);return I}function j(s,p,y,P){P||(T(typeof y=="boolean","missing or invalid endian"),T(p!=null,"missing offset"),T(p+1<s.length,"Trying to read beyond buffer length"));var O,P=s.length;if(!(P<=p))return y?(O=s[p],p+1<P&&(O|=s[p+1]<<8)):(O=s[p]<<8,p+1<P&&(O|=s[p+1])),O}function R(s,p,y,P){P||(T(typeof y=="boolean","missing or invalid endian"),T(p!=null,"missing offset"),T(p+3<s.length,"Trying to read beyond buffer length"));var O,P=s.length;if(!(P<=p))return y?(p+2<P&&(O=s[p+2]<<16),p+1<P&&(O|=s[p+1]<<8),O|=s[p],p+3<P&&(O+=s[p+3]<<24>>>0)):(p+1<P&&(O=s[p+1]<<16),p+2<P&&(O|=s[p+2]<<8),p+3<P&&(O|=s[p+3]),O+=s[p]<<24>>>0),O}function v(s,p,y,I){if(I||(T(typeof y=="boolean","missing or invalid endian"),T(p!=null,"missing offset"),T(p+1<s.length,"Trying to read beyond buffer length")),!(s.length<=p))return I=j(s,p,y,!0),32768&I?-1*(65535-I+1):I}function S(s,p,y,I){if(I||(T(typeof y=="boolean","missing or invalid endian"),T(p!=null,"missing offset"),T(p+3<s.length,"Trying to read beyond buffer length")),!(s.length<=p))return I=R(s,p,y,!0),2147483648&I?-1*(4294967295-I+1):I}function l(s,p,y,I){return I||(T(typeof y=="boolean","missing or invalid endian"),T(p+3<s.length,"Trying to read beyond buffer length")),x.read(s,p,y,23,4)}function g(s,p,y,I){return I||(T(typeof y=="boolean","missing or invalid endian"),T(p+7<s.length,"Trying to read beyond buffer length")),x.read(s,p,y,52,8)}function f(s,p,y,I,O){if(O||(T(p!=null,"missing value"),T(typeof I=="boolean","missing or invalid endian"),T(y!=null,"missing offset"),T(y+1<s.length,"trying to write beyond buffer length"),It(p,65535)),O=s.length,!(O<=y))for(var P=0,$=Math.min(O-y,2);P<$;P++)s[y+P]=(p&255<<8*(I?P:1-P))>>>8*(I?P:1-P)}function b(s,p,y,I,O){if(O||(T(p!=null,"missing value"),T(typeof I=="boolean","missing or invalid endian"),T(y!=null,"missing offset"),T(y+3<s.length,"trying to write beyond buffer length"),It(p,4294967295)),O=s.length,!(O<=y))for(var P=0,$=Math.min(O-y,4);P<$;P++)s[y+P]=p>>>8*(I?P:3-P)&255}function m(s,p,y,I,O){O||(T(p!=null,"missing value"),T(typeof I=="boolean","missing or invalid endian"),T(y!=null,"missing offset"),T(y+1<s.length,"Trying to write beyond buffer length"),Et(p,32767,-32768)),s.length<=y||f(s,0<=p?p:65535+p+1,y,I,O)}function D(s,p,y,I,O){O||(T(p!=null,"missing value"),T(typeof I=="boolean","missing or invalid endian"),T(y!=null,"missing offset"),T(y+3<s.length,"Trying to write beyond buffer length"),Et(p,2147483647,-2147483648)),s.length<=y||b(s,0<=p?p:4294967295+p+1,y,I,O)}function B(s,p,y,I,O){O||(T(p!=null,"missing value"),T(typeof I=="boolean","missing or invalid endian"),T(y!=null,"missing offset"),T(y+3<s.length,"Trying to write beyond buffer length"),Pt(p,34028234663852886e22,-34028234663852886e22)),s.length<=y||x.write(s,p,y,I,23,4)}function N(s,p,y,I,O){O||(T(p!=null,"missing value"),T(typeof I=="boolean","missing or invalid endian"),T(y!=null,"missing offset"),T(y+7<s.length,"Trying to write beyond buffer length"),Pt(p,17976931348623157e292,-17976931348623157e292)),s.length<=y||x.write(s,p,y,I,52,8)}i.Buffer=w,i.SlowBuffer=w,i.INSPECT_MAX_BYTES=50,w.poolSize=8192,w._useTypedArrays=function(){try{var s=new ArrayBuffer(0),p=new Uint8Array(s);return p.foo=function(){return 42},p.foo()===42&&typeof p.subarray=="function"}catch{return!1}}(),w.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},w.isBuffer=function(s){return!(s==null||!s._isBuffer)},w.byteLength=function(s,p){var y;switch(s+="",p||"utf8"){case"hex":y=s.length/2;break;case"utf8":case"utf-8":y=st(s).length;break;case"ascii":case"binary":case"raw":y=s.length;break;case"base64":y=at(s).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":y=2*s.length;break;default:throw new Error("Unknown encoding")}return y},w.concat=function(s,p){if(T(J(s),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),s.length===0)return new w(0);if(s.length===1)return s[0];if(typeof p!="number")for(O=p=0;O<s.length;O++)p+=s[O].length;for(var y=new w(p),I=0,O=0;O<s.length;O++){var P=s[O];P.copy(y,I),I+=P.length}return y},w.prototype.write=function(s,p,y,I){isFinite(p)?isFinite(y)||(I=y,y=void 0):(K=I,I=p,p=y,y=K),p=Number(p)||0;var O,P,$,z,K=this.length-p;switch((!y||K<(y=Number(y)))&&(y=K),I=String(I||"utf8").toLowerCase()){case"hex":O=function(ut,et,nt,H){nt=Number(nt)||0;var Y=ut.length-nt;(!H||Y<(H=Number(H)))&&(H=Y),T((Y=et.length)%2==0,"Invalid hex string"),Y/2<H&&(H=Y/2);for(var bt=0;bt<H;bt++){var me=parseInt(et.substr(2*bt,2),16);T(!isNaN(me),"Invalid hex string"),ut[nt+bt]=me}return w._charsWritten=2*bt,bt}(this,s,p,y);break;case"utf8":case"utf-8":P=this,$=p,z=y,O=w._charsWritten=vt(st(s),P,$,z);break;case"ascii":case"binary":O=k(this,s,p,y);break;case"base64":P=this,$=p,z=y,O=w._charsWritten=vt(at(s),P,$,z);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":O=C(this,s,p,y);break;default:throw new Error("Unknown encoding")}return O},w.prototype.toString=function(s,p,y){var I,O,P,$,z=this;if(s=String(s||"utf8").toLowerCase(),p=Number(p)||0,(y=y!==void 0?Number(y):z.length)===p)return"";switch(s){case"hex":I=function(K,ut,et){var nt=K.length;(!ut||ut<0)&&(ut=0),(!et||et<0||nt<et)&&(et=nt);for(var H="",Y=ut;Y<et;Y++)H+=q(K[Y]);return H}(z,p,y);break;case"utf8":case"utf-8":I=function(K,ut,et){var nt="",H="";et=Math.min(K.length,et);for(var Y=ut;Y<et;Y++)K[Y]<=127?(nt+=Tt(H)+String.fromCharCode(K[Y]),H=""):H+="%"+K[Y].toString(16);return nt+Tt(H)}(z,p,y);break;case"ascii":case"binary":I=E(z,p,y);break;case"base64":O=z,$=y,I=(P=p)===0&&$===O.length?A.fromByteArray(O):A.fromByteArray(O.slice(P,$));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":I=function(K,ut,et){for(var nt=K.slice(ut,et),H="",Y=0;Y<nt.length;Y+=2)H+=String.fromCharCode(nt[Y]+256*nt[Y+1]);return H}(z,p,y);break;default:throw new Error("Unknown encoding")}return I},w.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},w.prototype.copy=function(s,p,y,I){if(p=p||0,(I=I||I===0?I:this.length)!==(y=y||0)&&s.length!==0&&this.length!==0){T(y<=I,"sourceEnd < sourceStart"),T(0<=p&&p<s.length,"targetStart out of bounds"),T(0<=y&&y<this.length,"sourceStart out of bounds"),T(0<=I&&I<=this.length,"sourceEnd out of bounds"),I>this.length&&(I=this.length);var O=(I=s.length-p<I-y?s.length-p+y:I)-y;if(O<100||!w._useTypedArrays)for(var P=0;P<O;P++)s[P+p]=this[P+y];else s._set(this.subarray(y,y+O),p)}},w.prototype.slice=function(s,p){var y=this.length;if(s=F(s,y,0),p=F(p,y,y),w._useTypedArrays)return w._augment(this.subarray(s,p));for(var I=p-s,O=new w(I,void 0,!0),P=0;P<I;P++)O[P]=this[P+s];return O},w.prototype.get=function(s){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(s)},w.prototype.set=function(s,p){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(s,p)},w.prototype.readUInt8=function(s,p){if(p||(T(s!=null,"missing offset"),T(s<this.length,"Trying to read beyond buffer length")),!(s>=this.length))return this[s]},w.prototype.readUInt16LE=function(s,p){return j(this,s,!0,p)},w.prototype.readUInt16BE=function(s,p){return j(this,s,!1,p)},w.prototype.readUInt32LE=function(s,p){return R(this,s,!0,p)},w.prototype.readUInt32BE=function(s,p){return R(this,s,!1,p)},w.prototype.readInt8=function(s,p){if(p||(T(s!=null,"missing offset"),T(s<this.length,"Trying to read beyond buffer length")),!(s>=this.length))return 128&this[s]?-1*(255-this[s]+1):this[s]},w.prototype.readInt16LE=function(s,p){return v(this,s,!0,p)},w.prototype.readInt16BE=function(s,p){return v(this,s,!1,p)},w.prototype.readInt32LE=function(s,p){return S(this,s,!0,p)},w.prototype.readInt32BE=function(s,p){return S(this,s,!1,p)},w.prototype.readFloatLE=function(s,p){return l(this,s,!0,p)},w.prototype.readFloatBE=function(s,p){return l(this,s,!1,p)},w.prototype.readDoubleLE=function(s,p){return g(this,s,!0,p)},w.prototype.readDoubleBE=function(s,p){return g(this,s,!1,p)},w.prototype.writeUInt8=function(s,p,y){y||(T(s!=null,"missing value"),T(p!=null,"missing offset"),T(p<this.length,"trying to write beyond buffer length"),It(s,255)),p>=this.length||(this[p]=s)},w.prototype.writeUInt16LE=function(s,p,y){f(this,s,p,!0,y)},w.prototype.writeUInt16BE=function(s,p,y){f(this,s,p,!1,y)},w.prototype.writeUInt32LE=function(s,p,y){b(this,s,p,!0,y)},w.prototype.writeUInt32BE=function(s,p,y){b(this,s,p,!1,y)},w.prototype.writeInt8=function(s,p,y){y||(T(s!=null,"missing value"),T(p!=null,"missing offset"),T(p<this.length,"Trying to write beyond buffer length"),Et(s,127,-128)),p>=this.length||(0<=s?this.writeUInt8(s,p,y):this.writeUInt8(255+s+1,p,y))},w.prototype.writeInt16LE=function(s,p,y){m(this,s,p,!0,y)},w.prototype.writeInt16BE=function(s,p,y){m(this,s,p,!1,y)},w.prototype.writeInt32LE=function(s,p,y){D(this,s,p,!0,y)},w.prototype.writeInt32BE=function(s,p,y){D(this,s,p,!1,y)},w.prototype.writeFloatLE=function(s,p,y){B(this,s,p,!0,y)},w.prototype.writeFloatBE=function(s,p,y){B(this,s,p,!1,y)},w.prototype.writeDoubleLE=function(s,p,y){N(this,s,p,!0,y)},w.prototype.writeDoubleBE=function(s,p,y){N(this,s,p,!1,y)},w.prototype.fill=function(s,p,y){if(p=p||0,y=y||this.length,T(typeof(s=typeof(s=s||0)=="string"?s.charCodeAt(0):s)=="number"&&!isNaN(s),"value is not a number"),T(p<=y,"end < start"),y!==p&&this.length!==0){T(0<=p&&p<this.length,"start out of bounds"),T(0<=y&&y<=this.length,"end out of bounds");for(var I=p;I<y;I++)this[I]=s}},w.prototype.inspect=function(){for(var s=[],p=this.length,y=0;y<p;y++)if(s[y]=q(this[y]),y===i.INSPECT_MAX_BYTES){s[y+1]="...";break}return"<Buffer "+s.join(" ")+">"},w.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(w._useTypedArrays)return new w(this).buffer;for(var s=new Uint8Array(this.length),p=0,y=s.length;p<y;p+=1)s[p]=this[p];return s.buffer};var M=w.prototype;function F(s,p,y){return typeof s!="number"?y:p<=(s=~~s)?p:0<=s||0<=(s+=p)?s:0}function V(s){return(s=~~Math.ceil(+s))<0?0:s}function J(s){return(Array.isArray||function(p){return Object.prototype.toString.call(p)==="[object Array]"})(s)}function q(s){return s<16?"0"+s.toString(16):s.toString(16)}function st(s){for(var p=[],y=0;y<s.length;y++){var I=s.charCodeAt(y);if(I<=127)p.push(s.charCodeAt(y));else for(var O=y,P=(55296<=I&&I<=57343&&y++,encodeURIComponent(s.slice(O,y+1)).substr(1).split("%")),$=0;$<P.length;$++)p.push(parseInt(P[$],16))}return p}function at(s){return A.toByteArray(s)}function vt(s,p,y,I){for(var O=0;O<I&&!(O+y>=p.length||O>=s.length);O++)p[O+y]=s[O];return O}function Tt(s){try{return decodeURIComponent(s)}catch{return"ï¿½"}}function It(s,p){T(typeof s=="number","cannot write a non-number as a number"),T(0<=s,"specified a negative value for writing an unsigned value"),T(s<=p,"value is larger than maximum value for type"),T(Math.floor(s)===s,"value has a fractional component")}function Et(s,p,y){T(typeof s=="number","cannot write a non-number as a number"),T(s<=p,"value larger than maximum allowed value"),T(y<=s,"value smaller than minimum allowed value"),T(Math.floor(s)===s,"value has a fractional component")}function Pt(s,p,y){T(typeof s=="number","cannot write a non-number as a number"),T(s<=p,"value larger than maximum allowed value"),T(y<=s,"value smaller than minimum allowed value")}function T(s,p){if(!s)throw new Error(p||"Failed assertion")}w._augment=function(s){return s._isBuffer=!0,s._get=s.get,s._set=s.set,s.get=M.get,s.set=M.set,s.write=M.write,s.toString=M.toString,s.toLocaleString=M.toString,s.toJSON=M.toJSON,s.copy=M.copy,s.slice=M.slice,s.readUInt8=M.readUInt8,s.readUInt16LE=M.readUInt16LE,s.readUInt16BE=M.readUInt16BE,s.readUInt32LE=M.readUInt32LE,s.readUInt32BE=M.readUInt32BE,s.readInt8=M.readInt8,s.readInt16LE=M.readInt16LE,s.readInt16BE=M.readInt16BE,s.readInt32LE=M.readInt32LE,s.readInt32BE=M.readInt32BE,s.readFloatLE=M.readFloatLE,s.readFloatBE=M.readFloatBE,s.readDoubleLE=M.readDoubleLE,s.readDoubleBE=M.readDoubleBE,s.writeUInt8=M.writeUInt8,s.writeUInt16LE=M.writeUInt16LE,s.writeUInt16BE=M.writeUInt16BE,s.writeUInt32LE=M.writeUInt32LE,s.writeUInt32BE=M.writeUInt32BE,s.writeInt8=M.writeInt8,s.writeInt16LE=M.writeInt16LE,s.writeInt16BE=M.writeInt16BE,s.writeInt32LE=M.writeInt32LE,s.writeInt32BE=M.writeInt32BE,s.writeFloatLE=M.writeFloatLE,s.writeFloatBE=M.writeFloatBE,s.writeDoubleLE=M.writeDoubleLE,s.writeDoubleBE=M.writeDoubleBE,s.fill=M.fill,s.inspect=M.inspect,s.toArrayBuffer=M.toArrayBuffer,s}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(e,r,i){(function(o,u,A,h,c,d,_,U,L){var A=e("buffer").Buffer,x=4,w=new A(x);w.fill(0),r.exports={hash:function(k,C,E,j){for(var R=C(function(f,b){f.length%x!=0&&(m=f.length+(x-f.length%x),f=A.concat([f,w],m));for(var m,D=[],B=b?f.readInt32BE:f.readInt32LE,N=0;N<f.length;N+=x)D.push(B.call(f,N));return D}(k=A.isBuffer(k)?k:new A(k),j),8*k.length),C=j,v=new A(E),S=C?v.writeInt32BE:v.writeInt32LE,l=0;l<R.length;l++)S.call(v,R[l],4*l,!0);return v}}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(e,r,i){(function(o,u,A,h,c,d,_,U,L){var A=e("buffer").Buffer,x=e("./sha"),w=e("./sha256"),k=e("./rng"),C={sha1:x,sha256:w,md5:e("./md5")},E=64,j=new A(E);function R(f,b){var m=C[f=f||"sha1"],D=[];return m||v("algorithm:",f,"is not yet supported"),{update:function(B){return A.isBuffer(B)||(B=new A(B)),D.push(B),B.length,this},digest:function(B){var N=A.concat(D),N=b?function(M,F,V){A.isBuffer(F)||(F=new A(F)),A.isBuffer(V)||(V=new A(V)),F.length>E?F=M(F):F.length<E&&(F=A.concat([F,j],E));for(var J=new A(E),q=new A(E),st=0;st<E;st++)J[st]=54^F[st],q[st]=92^F[st];return V=M(A.concat([J,V])),M(A.concat([q,V]))}(m,b,N):m(N);return D=null,B?N.toString(B):N}}}function v(){var f=[].slice.call(arguments).join(" ");throw new Error([f,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}j.fill(0),i.createHash=function(f){return R(f)},i.createHmac=R,i.randomBytes=function(f,b){if(!b||!b.call)return new A(k(f));try{b.call(this,void 0,new A(k(f)))}catch(m){b(m)}};var S,l=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],g=function(f){i[f]=function(){v("sorry,",f,"is not implemented yet")}};for(S in l)g(l[S])}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){var A=e("./helpers");function x(v,S){v[S>>5]|=128<<S%32,v[14+(S+64>>>9<<4)]=S;for(var l=1732584193,g=-271733879,f=-1732584194,b=271733878,m=0;m<v.length;m+=16){var D=l,B=g,N=f,M=b,l=k(l,g,f,b,v[m+0],7,-680876936),b=k(b,l,g,f,v[m+1],12,-389564586),f=k(f,b,l,g,v[m+2],17,606105819),g=k(g,f,b,l,v[m+3],22,-1044525330);l=k(l,g,f,b,v[m+4],7,-176418897),b=k(b,l,g,f,v[m+5],12,1200080426),f=k(f,b,l,g,v[m+6],17,-1473231341),g=k(g,f,b,l,v[m+7],22,-45705983),l=k(l,g,f,b,v[m+8],7,1770035416),b=k(b,l,g,f,v[m+9],12,-1958414417),f=k(f,b,l,g,v[m+10],17,-42063),g=k(g,f,b,l,v[m+11],22,-1990404162),l=k(l,g,f,b,v[m+12],7,1804603682),b=k(b,l,g,f,v[m+13],12,-40341101),f=k(f,b,l,g,v[m+14],17,-1502002290),l=C(l,g=k(g,f,b,l,v[m+15],22,1236535329),f,b,v[m+1],5,-165796510),b=C(b,l,g,f,v[m+6],9,-1069501632),f=C(f,b,l,g,v[m+11],14,643717713),g=C(g,f,b,l,v[m+0],20,-373897302),l=C(l,g,f,b,v[m+5],5,-701558691),b=C(b,l,g,f,v[m+10],9,38016083),f=C(f,b,l,g,v[m+15],14,-660478335),g=C(g,f,b,l,v[m+4],20,-405537848),l=C(l,g,f,b,v[m+9],5,568446438),b=C(b,l,g,f,v[m+14],9,-1019803690),f=C(f,b,l,g,v[m+3],14,-187363961),g=C(g,f,b,l,v[m+8],20,1163531501),l=C(l,g,f,b,v[m+13],5,-1444681467),b=C(b,l,g,f,v[m+2],9,-51403784),f=C(f,b,l,g,v[m+7],14,1735328473),l=E(l,g=C(g,f,b,l,v[m+12],20,-1926607734),f,b,v[m+5],4,-378558),b=E(b,l,g,f,v[m+8],11,-2022574463),f=E(f,b,l,g,v[m+11],16,1839030562),g=E(g,f,b,l,v[m+14],23,-35309556),l=E(l,g,f,b,v[m+1],4,-1530992060),b=E(b,l,g,f,v[m+4],11,1272893353),f=E(f,b,l,g,v[m+7],16,-155497632),g=E(g,f,b,l,v[m+10],23,-1094730640),l=E(l,g,f,b,v[m+13],4,681279174),b=E(b,l,g,f,v[m+0],11,-358537222),f=E(f,b,l,g,v[m+3],16,-722521979),g=E(g,f,b,l,v[m+6],23,76029189),l=E(l,g,f,b,v[m+9],4,-640364487),b=E(b,l,g,f,v[m+12],11,-421815835),f=E(f,b,l,g,v[m+15],16,530742520),l=j(l,g=E(g,f,b,l,v[m+2],23,-995338651),f,b,v[m+0],6,-198630844),b=j(b,l,g,f,v[m+7],10,1126891415),f=j(f,b,l,g,v[m+14],15,-1416354905),g=j(g,f,b,l,v[m+5],21,-57434055),l=j(l,g,f,b,v[m+12],6,1700485571),b=j(b,l,g,f,v[m+3],10,-1894986606),f=j(f,b,l,g,v[m+10],15,-1051523),g=j(g,f,b,l,v[m+1],21,-2054922799),l=j(l,g,f,b,v[m+8],6,1873313359),b=j(b,l,g,f,v[m+15],10,-30611744),f=j(f,b,l,g,v[m+6],15,-1560198380),g=j(g,f,b,l,v[m+13],21,1309151649),l=j(l,g,f,b,v[m+4],6,-145523070),b=j(b,l,g,f,v[m+11],10,-1120210379),f=j(f,b,l,g,v[m+2],15,718787259),g=j(g,f,b,l,v[m+9],21,-343485551),l=R(l,D),g=R(g,B),f=R(f,N),b=R(b,M)}return Array(l,g,f,b)}function w(v,S,l,g,f,b){return R((S=R(R(S,v),R(g,b)))<<f|S>>>32-f,l)}function k(v,S,l,g,f,b,m){return w(S&l|~S&g,v,S,f,b,m)}function C(v,S,l,g,f,b,m){return w(S&g|l&~g,v,S,f,b,m)}function E(v,S,l,g,f,b,m){return w(S^l^g,v,S,f,b,m)}function j(v,S,l,g,f,b,m){return w(l^(S|~g),v,S,f,b,m)}function R(v,S){var l=(65535&v)+(65535&S);return(v>>16)+(S>>16)+(l>>16)<<16|65535&l}r.exports=function(v){return A.hash(v,x,16)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){r.exports=function(A){for(var x,w=new Array(A),k=0;k<A;k++)!(3&k)&&(x=4294967296*Math.random()),w[k]=x>>>((3&k)<<3)&255;return w}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){var A=e("./helpers");function x(C,E){C[E>>5]|=128<<24-E%32,C[15+(E+64>>9<<4)]=E;for(var j,R,v,S=Array(80),l=1732584193,g=-271733879,f=-1732584194,b=271733878,m=-1009589776,D=0;D<C.length;D+=16){for(var B=l,N=g,M=f,F=b,V=m,J=0;J<80;J++){S[J]=J<16?C[D+J]:k(S[J-3]^S[J-8]^S[J-14]^S[J-16],1);var q=w(w(k(l,5),(q=g,R=f,v=b,(j=J)<20?q&R|~q&v:!(j<40)&&j<60?q&R|q&v|R&v:q^R^v)),w(w(m,S[J]),(j=J)<20?1518500249:j<40?1859775393:j<60?-1894007588:-899497514)),m=b,b=f,f=k(g,30),g=l,l=q}l=w(l,B),g=w(g,N),f=w(f,M),b=w(b,F),m=w(m,V)}return Array(l,g,f,b,m)}function w(C,E){var j=(65535&C)+(65535&E);return(C>>16)+(E>>16)+(j>>16)<<16|65535&j}function k(C,E){return C<<E|C>>>32-E}r.exports=function(C){return A.hash(C,x,20,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){function A(E,j){var R=(65535&E)+(65535&j);return(E>>16)+(j>>16)+(R>>16)<<16|65535&R}function x(E,j){var R,v=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),S=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),l=new Array(64);E[j>>5]|=128<<24-j%32,E[15+(j+64>>9<<4)]=j;for(var g,f,b=0;b<E.length;b+=16){for(var m=S[0],D=S[1],B=S[2],N=S[3],M=S[4],F=S[5],V=S[6],J=S[7],q=0;q<64;q++)l[q]=q<16?E[q+b]:A(A(A((f=l[q-2],k(f,17)^k(f,19)^C(f,10)),l[q-7]),(f=l[q-15],k(f,7)^k(f,18)^C(f,3))),l[q-16]),R=A(A(A(A(J,k(f=M,6)^k(f,11)^k(f,25)),M&F^~M&V),v[q]),l[q]),g=A(k(g=m,2)^k(g,13)^k(g,22),m&D^m&B^D&B),J=V,V=F,F=M,M=A(N,R),N=B,B=D,D=m,m=A(R,g);S[0]=A(m,S[0]),S[1]=A(D,S[1]),S[2]=A(B,S[2]),S[3]=A(N,S[3]),S[4]=A(M,S[4]),S[5]=A(F,S[5]),S[6]=A(V,S[6]),S[7]=A(J,S[7])}return S}var w=e("./helpers"),k=function(E,j){return E>>>j|E<<32-j},C=function(E,j){return E>>>j};r.exports=function(E){return w.hash(E,x,32,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){i.read=function(A,x,w,k,b){var E,j,R=8*b-k-1,v=(1<<R)-1,S=v>>1,l=-7,g=w?b-1:0,f=w?-1:1,b=A[x+g];for(g+=f,E=b&(1<<-l)-1,b>>=-l,l+=R;0<l;E=256*E+A[x+g],g+=f,l-=8);for(j=E&(1<<-l)-1,E>>=-l,l+=k;0<l;j=256*j+A[x+g],g+=f,l-=8);if(E===0)E=1-S;else{if(E===v)return j?NaN:1/0*(b?-1:1);j+=Math.pow(2,k),E-=S}return(b?-1:1)*j*Math.pow(2,E-k)},i.write=function(A,x,w,k,C,m){var j,R,v=8*m-C-1,S=(1<<v)-1,l=S>>1,g=C===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=k?0:m-1,b=k?1:-1,m=x<0||x===0&&1/x<0?1:0;for(x=Math.abs(x),isNaN(x)||x===1/0?(R=isNaN(x)?1:0,j=S):(j=Math.floor(Math.log(x)/Math.LN2),x*(k=Math.pow(2,-j))<1&&(j--,k*=2),2<=(x+=1<=j+l?g/k:g*Math.pow(2,1-l))*k&&(j++,k/=2),S<=j+l?(R=0,j=S):1<=j+l?(R=(x*k-1)*Math.pow(2,C),j+=l):(R=x*Math.pow(2,l-1)*Math.pow(2,C),j=0));8<=C;A[w+f]=255&R,f+=b,R/=256,C-=8);for(j=j<<C|R,v+=C;0<v;A[w+f]=255&j,f+=b,j/=256,v-=8);A[w+f-b]|=128*m}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(e,r,i){(function(o,u,a,h,c,d,_,U,L){var A,x,w;function k(){}(o=r.exports={}).nextTick=(x=typeof window<"u"&&window.setImmediate,w=typeof window<"u"&&window.postMessage&&window.addEventListener,x?function(C){return window.setImmediate(C)}:w?(A=[],window.addEventListener("message",function(C){var E=C.source;E!==window&&E!==null||C.data!=="process-tick"||(C.stopPropagation(),0<A.length&&A.shift()())},!0),function(C){A.push(C),window.postMessage("process-tick","*")}):function(C){setTimeout(C,0)}),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=k,o.addListener=k,o.once=k,o.off=k,o.removeListener=k,o.removeAllListeners=k,o.emit=k,o.binding=function(C){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(C){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(ze);var yn=ze.exports;const _t=yn.MD5;function it(n){for(var t=arguments.length,e=Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+n+(e.length?" "+e.map(function(i){return"'"+i+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function mt(n){return!!n&&!!n[W]}function ht(n){return!!n&&(function(t){if(!t||typeof t!="object")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||typeof r=="function"&&Function.toString.call(r)===En}(n)||Array.isArray(n)||!!n[xe]||!!n.constructor[xe]||de(n)||le(n))}function St(n,t,e){e===void 0&&(e=!1),Ot(n)===0?(e?Object.keys:ve)(n).forEach(function(r){e&&typeof r=="symbol"||t(r,n[r],n)}):n.forEach(function(r,i){return t(i,r,n)})}function Ot(n){var t=n[W];return t?t.i>3?t.i-4:t.i:Array.isArray(n)?1:de(n)?2:le(n)?3:0}function ne(n,t){return Ot(n)===2?n.has(t):Object.prototype.hasOwnProperty.call(n,t)}function vn(n,t){return Ot(n)===2?n.get(t):n[t]}function Ye(n,t,e){var r=Ot(n);r===2?n.set(t,e):r===3?(n.delete(t),n.add(e)):n[t]=e}function bn(n,t){return n===t?n!==0||1/n==1/t:n!=n&&t!=t}function de(n){return On&&n instanceof Map}function le(n){return In&&n instanceof Set}function Q(n){return n.o||n.t}function he(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var t=jn(n);delete t[W];for(var e=ve(t),r=0;r<e.length;r++){var i=e[r],o=t[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]})}return Object.create(Object.getPrototypeOf(n),t)}function pe(n,t){return t===void 0&&(t=!1),ge(n)||mt(n)||!ht(n)||(Ot(n)>1&&(n.set=n.add=n.clear=n.delete=_n),Object.freeze(n),t&&St(n,function(e,r){return pe(r,!0)},!0)),n}function _n(){it(2)}function ge(n){return n==null||typeof n!="object"||Object.isFrozen(n)}function ft(n){var t=ie[n];return t||it(18,n),t}function wn(n,t){ie[n]||(ie[n]=t)}function Ft(){return Ut}function Qt(n,t){t&&(ft("Patches"),n.u=[],n.s=[],n.v=t)}function qt(n){re(n),n.p.forEach(mn),n.p=null}function re(n){n===Ut&&(Ut=n.l)}function Se(n){return Ut={p:[],l:Ut,h:n,m:!0,_:0}}function mn(n){var t=n[W];t.i===0||t.i===1?t.j():t.O=!0}function Gt(n,t){t._=t.p.length;var e=t.p[0],r=n!==void 0&&n!==e;return t.h.g||ft("ES5").S(t,n,r),r?(e[W].P&&(qt(t),it(4)),ht(n)&&(n=Wt(t,n),t.l||Jt(t,n)),t.u&&ft("Patches").M(e[W].t,n,t.u,t.s)):n=Wt(t,e,[]),qt(t),t.u&&t.v(t.u,t.s),n!==Ke?n:void 0}function Wt(n,t,e){if(ge(t))return t;var r=t[W];if(!r)return St(t,function(o,u){return Ae(n,r,t,o,u,e)},!0),t;if(r.A!==n)return t;if(!r.P)return Jt(n,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=r.i===4||r.i===5?r.o=he(r.k):r.o;St(r.i===3?new Set(i):i,function(o,u){return Ae(n,r,i,o,u,e)}),Jt(n,i,!1),e&&n.u&&ft("Patches").R(r,e,n.u,n.s)}return r.o}function Ae(n,t,e,r,i,o){if(mt(i)){var u=Wt(n,i,o&&t&&t.i!==3&&!ne(t.D,r)?o.concat(r):void 0);if(Ye(e,r,u),!mt(u))return;n.m=!1}if(ht(i)&&!ge(i)){if(!n.h.F&&n._<1)return;Wt(n,i),t&&t.A.l||Jt(n,i)}}function Jt(n,t,e){e===void 0&&(e=!1),n.h.F&&n.m&&pe(t,e)}function Xt(n,t){var e=n[W];return(e?Q(e):n)[t]}function Oe(n,t){if(t in n)for(var e=Object.getPrototypeOf(n);e;){var r=Object.getOwnPropertyDescriptor(e,t);if(r)return r;e=Object.getPrototypeOf(e)}}function dt(n){n.P||(n.P=!0,n.l&&dt(n.l))}function Zt(n){n.o||(n.o=he(n.t))}function kt(n,t,e){var r=de(t)?ft("MapSet").N(t,e):le(t)?ft("MapSet").T(t,e):n.g?function(i,o){var u=Array.isArray(i),a={i:u?1:0,A:o?o.A:Ft(),P:!1,I:!1,D:{},l:o,t:i,k:null,o:null,j:null,C:!1},h=a,c=oe;u&&(h=[a],c=xt);var d=Proxy.revocable(h,c),_=d.revoke,U=d.proxy;return a.k=U,a.j=_,U}(t,e):ft("ES5").J(t,e);return(e?e.A:Ft()).p.push(r),r}function Sn(n){return mt(n)||it(22,n),function t(e){if(!ht(e))return e;var r,i=e[W],o=Ot(e);if(i){if(!i.P&&(i.i<4||!ft("ES5").K(i)))return i.t;i.I=!0,r=Ie(e,o),i.I=!1}else r=Ie(e,o);return St(r,function(u,a){i&&vn(i.t,u)===a||Ye(r,u,t(a))}),o===3?new Set(r):r}(n)}function Ie(n,t){switch(t){case 2:return new Map(n);case 3:return Array.from(n)}return he(n)}function An(){function n(a,h){function c(){this.constructor=a}i(a,h),a.prototype=(c.prototype=h.prototype,new c)}function t(a){a.o||(a.D=new Map,a.o=new Map(a.t))}function e(a){a.o||(a.o=new Set,a.t.forEach(function(h){if(ht(h)){var c=kt(a.A.h,h,a);a.p.set(h,c),a.o.add(c)}else a.o.add(h)}))}function r(a){a.O&&it(3,JSON.stringify(Q(a)))}var i=function(a,h){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var _ in d)d.hasOwnProperty(_)&&(c[_]=d[_])})(a,h)},o=function(){function a(c,d){return this[W]={i:2,l:d,A:d?d.A:Ft(),P:!1,I:!1,o:void 0,D:void 0,t:c,k:this,C:!1,O:!1},this}n(a,Map);var h=a.prototype;return Object.defineProperty(h,"size",{get:function(){return Q(this[W]).size}}),h.has=function(c){return Q(this[W]).has(c)},h.set=function(c,d){var _=this[W];return r(_),Q(_).has(c)&&Q(_).get(c)===d||(t(_),dt(_),_.D.set(c,!0),_.o.set(c,d),_.D.set(c,!0)),this},h.delete=function(c){if(!this.has(c))return!1;var d=this[W];return r(d),t(d),dt(d),d.t.has(c)?d.D.set(c,!1):d.D.delete(c),d.o.delete(c),!0},h.clear=function(){var c=this[W];r(c),Q(c).size&&(t(c),dt(c),c.D=new Map,St(c.t,function(d){c.D.set(d,!1)}),c.o.clear())},h.forEach=function(c,d){var _=this;Q(this[W]).forEach(function(U,L){c.call(d,_.get(L),L,_)})},h.get=function(c){var d=this[W];r(d);var _=Q(d).get(c);if(d.I||!ht(_)||_!==d.t.get(c))return _;var U=kt(d.A.h,_,d);return t(d),d.o.set(c,U),U},h.keys=function(){return Q(this[W]).keys()},h.values=function(){var c,d=this,_=this.keys();return(c={})[Rt]=function(){return d.values()},c.next=function(){var U=_.next();return U.done?U:{done:!1,value:d.get(U.value)}},c},h.entries=function(){var c,d=this,_=this.keys();return(c={})[Rt]=function(){return d.entries()},c.next=function(){var U=_.next();if(U.done)return U;var L=d.get(U.value);return{done:!1,value:[U.value,L]}},c},h[Rt]=function(){return this.entries()},a}(),u=function(){function a(c,d){return this[W]={i:3,l:d,A:d?d.A:Ft(),P:!1,I:!1,o:void 0,t:c,k:this,p:new Map,O:!1,C:!1},this}n(a,Set);var h=a.prototype;return Object.defineProperty(h,"size",{get:function(){return Q(this[W]).size}}),h.has=function(c){var d=this[W];return r(d),d.o?!!d.o.has(c)||!(!d.p.has(c)||!d.o.has(d.p.get(c))):d.t.has(c)},h.add=function(c){var d=this[W];return r(d),this.has(c)||(e(d),dt(d),d.o.add(c)),this},h.delete=function(c){if(!this.has(c))return!1;var d=this[W];return r(d),e(d),dt(d),d.o.delete(c)||!!d.p.has(c)&&d.o.delete(d.p.get(c))},h.clear=function(){var c=this[W];r(c),Q(c).size&&(e(c),dt(c),c.o.clear())},h.values=function(){var c=this[W];return r(c),e(c),c.o.values()},h.entries=function(){var c=this[W];return r(c),e(c),c.o.entries()},h.keys=function(){return this.values()},h[Rt]=function(){return this.values()},h.forEach=function(c,d){for(var _=this.values(),U=_.next();!U.done;)c.call(d,U.value,U.value,this),U=_.next()},a}();wn("MapSet",{N:function(a,h){return new o(a,h)},T:function(a,h){return new u(a,h)}})}var Ee,Ut,ye=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",On=typeof Map<"u",In=typeof Set<"u",je=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",Ke=ye?Symbol.for("immer-nothing"):((Ee={})["immer-nothing"]=!0,Ee),xe=ye?Symbol.for("immer-draftable"):"__$immer_draftable",W=ye?Symbol.for("immer-state"):"__$immer_state",Rt=typeof Symbol<"u"&&Symbol.iterator||"@@iterator",En=""+Object.prototype.constructor,ve=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,jn=Object.getOwnPropertyDescriptors||function(n){var t={};return ve(n).forEach(function(e){t[e]=Object.getOwnPropertyDescriptor(n,e)}),t},ie={},oe={get:function(n,t){if(t===W)return n;var e=Q(n);if(!ne(e,t))return function(i,o,u){var a,h=Oe(o,u);return h?"value"in h?h.value:(a=h.get)===null||a===void 0?void 0:a.call(i.k):void 0}(n,e,t);var r=e[t];return n.I||!ht(r)?r:r===Xt(n.t,t)?(Zt(n),n.o[t]=kt(n.A.h,r,n)):r},has:function(n,t){return t in Q(n)},ownKeys:function(n){return Reflect.ownKeys(Q(n))},set:function(n,t,e){var r=Oe(Q(n),t);if(r!=null&&r.set)return r.set.call(n.k,e),!0;if(!n.P){var i=Xt(Q(n),t),o=i==null?void 0:i[W];if(o&&o.t===e)return n.o[t]=e,n.D[t]=!1,!0;if(bn(e,i)&&(e!==void 0||ne(n.t,t)))return!0;Zt(n),dt(n)}return n.o[t]===e&&typeof e!="number"&&(e!==void 0||t in n.o)||(n.o[t]=e,n.D[t]=!0,!0)},deleteProperty:function(n,t){return Xt(n.t,t)!==void 0||t in n.t?(n.D[t]=!1,Zt(n),dt(n)):delete n.D[t],n.o&&delete n.o[t],!0},getOwnPropertyDescriptor:function(n,t){var e=Q(n),r=Reflect.getOwnPropertyDescriptor(e,t);return r&&{writable:!0,configurable:n.i!==1||t!=="length",enumerable:r.enumerable,value:e[t]}},defineProperty:function(){it(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){it(12)}},xt={};St(oe,function(n,t){xt[n]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),xt.deleteProperty=function(n,t){return xt.set.call(this,n,t,void 0)},xt.set=function(n,t,e){return oe.set.call(this,n[0],t,e,n[0])};var xn=function(){function n(e){var r=this;this.g=je,this.F=!0,this.produce=function(i,o,u){if(typeof i=="function"&&typeof o!="function"){var a=o;o=i;var h=r;return function(x){var w=this;x===void 0&&(x=a);for(var k=arguments.length,C=Array(k>1?k-1:0),E=1;E<k;E++)C[E-1]=arguments[E];return h.produce(x,function(j){var R;return(R=o).call.apply(R,[w,j].concat(C))})}}var c;if(typeof o!="function"&&it(6),u!==void 0&&typeof u!="function"&&it(7),ht(i)){var d=Se(r),_=kt(r,i,void 0),U=!0;try{c=o(_),U=!1}finally{U?qt(d):re(d)}return typeof Promise<"u"&&c instanceof Promise?c.then(function(x){return Qt(d,u),Gt(x,d)},function(x){throw qt(d),x}):(Qt(d,u),Gt(c,d))}if(!i||typeof i!="object"){if((c=o(i))===void 0&&(c=i),c===Ke&&(c=void 0),r.F&&pe(c,!0),u){var L=[],A=[];ft("Patches").M(i,c,L,A),u(L,A)}return c}it(21,i)},this.produceWithPatches=function(i,o){if(typeof i=="function")return function(c){for(var d=arguments.length,_=Array(d>1?d-1:0),U=1;U<d;U++)_[U-1]=arguments[U];return r.produceWithPatches(c,function(L){return i.apply(void 0,[L].concat(_))})};var u,a,h=r.produce(i,o,function(c,d){u=c,a=d});return typeof Promise<"u"&&h instanceof Promise?h.then(function(c){return[c,u,a]}):[h,u,a]},typeof(e==null?void 0:e.useProxies)=="boolean"&&this.setUseProxies(e.useProxies),typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze)}var t=n.prototype;return t.createDraft=function(e){ht(e)||it(8),mt(e)&&(e=Sn(e));var r=Se(this),i=kt(this,e,void 0);return i[W].C=!0,re(r),i},t.finishDraft=function(e,r){var i=e&&e[W],o=i.A;return Qt(o,r),Gt(void 0,o)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!je&&it(20),this.g=e},t.applyPatches=function(e,r){var i;for(i=r.length-1;i>=0;i--){var o=r[i];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}i>-1&&(r=r.slice(i+1));var u=ft("Patches").$;return mt(e)?u(e,r):this.produce(e,function(a){return u(a,r)})},n}(),rt=new xn,kn=rt.produce;rt.produceWithPatches.bind(rt);rt.setAutoFreeze.bind(rt);rt.setUseProxies.bind(rt);rt.applyPatches.bind(rt);rt.createDraft.bind(rt);rt.finishDraft.bind(rt);function He(n,t){const e=Object.keys(n),r=Object.keys(t);return e.length===r.length&&Object.keys(n).every(i=>t.hasOwnProperty(i))}function ke(n,t){return Object.keys(n).length===Object.keys(t).length&&Object.keys(n).every(e=>t.hasOwnProperty(e)&&n[e]===t[e])}function $t(n,t){return typeof n!="object"||typeof t!="object"||n===null||t===null?n===t:He(n,t)?Object.keys(n).every(e=>$t(n[e],t[e])):!1}function Qe(n,t){if(!wt(n)||!wt(t))return t;const e={};for(const r of Object.keys(n))e[r]=n[r];for(const r of Object.keys(t)){if(t[r]===null)continue;const i=wt(n[r])&&wt(t[r]);e[r]=i?Qe(n[r],t[r]):t[r]}return e}function Ge(n,t,e){if(!wt(n))return n;const r={};for(const[i,o]of Object.entries(n))r[i]=wt(o)?Ge(o,t,e):o===t?e:o;return r}function wt(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}An();function Un(n){return n.cardinality==="one"}function be(n){return n["value-type"]==="ref"}function Cn(n){return n["value-type"]==="blob"}function zt(n,t){return n[t]}function _e(n,t){return t.reduce((e,r)=>e&&e.get(r),n)}function lt(n,t){if(t.length===0)throw new Error("path must have at least one element");if(t.length===1){n.delete(t[0]);return}const[e,...r]=t;n.has(e)&&lt(n.get(e),r)}function ct(n,t,e){if(t.length===0)throw new Error("path must have at least one element");if(t.length===1){n.set(t[0],e);return}const[r,...i]=t;let o=n.get(r);o||(o=new Map,n.set(r,o)),ct(o,i,e)}function Xe(n,t){const e=new Map,r=new Map,i=new Map;for(const o of t){const[u,a,h,c]=o,d=zt(n,a);if(!d){console.warn("no such attr",u,n);continue}be(d)&&ct(i,[h,a,u],o),ct(e,[u,a,h],o),ct(r,[a,u,h],o)}return{eav:e,aev:r,vae:i}}function Ue(n,t,e,r){const i=Xe(n,t);return i.attrs=n,i.cardinalityInference=e,i.linkIndex=r,i}function Yt(n,t){var e,r;let i;if(Array.isArray(t[0])){const[u,a]=t[0],h=n.aev.get(u);if(!h)return null;i=(e=gt(h,2).find(d=>d[2]===a))===null||e===void 0?void 0:e[0]}else i=t[0];if(!i)return null;const o=t[2];if(Array.isArray(o)&&o.length===2&&n.aev.get(o[0])){const[u,a]=o,h=n.aev.get(u);if(!h)return null;const d=(r=gt(h,2).find(x=>x[2]===a))===null||r===void 0?void 0:r[0];if(!d)return null;const[_,U,L,...A]=t;return[i,U,d,...A]}else{const[u,...a]=t;return[i,...a]}}function Mn(n,t){const e=Yt(n,t);if(!e)return;const[r,i,o]=e,u=zt(n.attrs,i);u&&(lt(n.eav,[r,i,o]),lt(n.aev,[i,r,o]),be(u)&&lt(n.vae,[o,i,r]))}let Tn=0;function Ze(n,t,e){const[r,i,o]=e;let u;const a=_e(n.ea,[r,i,o]);return a&&(u=a[3]),u||Date.now()*10+Tn++}function Pn(n,t){var e;const r=Yt(n,t);if(!r)return;const[i,o,u]=r,a=zt(n.attrs,o);if(!a)return;const h=_e(n.eav,[i,o,u]),c=(e=h==null?void 0:h[3])!==null&&e!==void 0?e:Ze(n,a,r),d=[i,o,u,c];Un(a)?(ct(n.eav,[i,o],new Map([[u,d]])),ct(n.aev,[o,i],new Map([[u,d]]))):(ct(n.eav,[i,o,u],d),ct(n.aev,[o,i,u],d)),be(a)&&ct(n.vae,[u,o,i],d)}function Ln(n,t){var e;const r=Yt(n,t);if(!r)return;const[i,o,u]=r,a=zt(n.attrs,o);if(!a)return;if(!Cn(a))throw new Error("merge operation is not supported for links");const h=_e(n.eav,[i,o]);if(!h)return;const c=(e=h.values().next())===null||e===void 0?void 0:e.value;if(!c)return;const d=c[2],_=Qe(d,u),U=[i,o,_,Ze(n,a,c)];ct(n.eav,[i,o],new Map([[_,U]]))}function Rn(n,t){const e=Yt(n,t);if(!e)return;const[r]=e,i=n.eav.get(r);if(i)for(const u of i.keys())lt(n.aev,[u,r]);lt(n.eav,[r]);const o=n.vae.get(r)&&gt(n.vae.get(r),2);o&&o.forEach(u=>{const[a,h,c]=u;lt(n.eav,[a,h,c]),lt(n.aev,[h,a,c])}),lt(n.vae,[r])}function tn(n,t){const e=Xe(n.attrs,t);Object.keys(e).forEach(r=>{n[r]=e[r]})}function Bn(n,[t]){n.attrs[t.id]=t}function en(n){return gt(n.eav,3)}function Dn(n,[t]){if(!n.attrs[t])return;const e=en(n).filter(([r,i])=>i!==t);delete n.attrs[t],tn(n,e)}function Nn(n,[t]){const e=n.attrs[t.id];e&&(n.attrs[t.id]=Object.assign(Object.assign({},e),t),tn(n,en(n)))}function $n(n,t){const[e,...r]=t;switch(e){case"add-triple":Pn(n,r);break;case"deep-merge-triple":Ln(n,r);break;case"retract-triple":Mn(n,r);break;case"delete-entity":Rn(n,r);break;case"add-attr":Bn(n,r);break;case"delete-attr":Dn(n,r);break;case"update-attr":Nn(n,r);break;default:throw new Error(`unhandled transaction action: ${e}`)}}function gt(n,t,e=[]){if(!n||t===0)return e;if(t===1){for(const r of n.values())e.push(r);return e}for(const r of n.values())gt(r,t-1,e);return e}function Bt(n,t){const e=[],r=t.in?t.in:[t];for(const i of r){const o=n.get(i);o&&e.push(o)}return e}function Fn(n,t,e){let r="";return n!==void 0&&(r+="e"),t!==void 0&&(r+="a"),e!==void 0&&(r+="v"),r}function qn(n,[t,e,r]){var i,o;switch(Fn(t,e,r)){case"e":{const a=n.eav.get(t);return gt(a,2)}case"ea":{const a=(i=n.eav.get(t))===null||i===void 0?void 0:i.get(e);return gt(a,1)}case"eav":{const a=(o=n.eav.get(t))===null||o===void 0?void 0:o.get(e);return a?Bt(a,r):[]}case"ev":{const a=n.eav.get(t);if(!a)return[];const h=[];for(const c of a.values())h.push(...Bt(c,r));return h}case"av":{const a=n.aev.get(e);if(!a)return[];const h=[];for(const c of a.values())h.push(...Bt(c,r));return h}case"v":{const a=[];for(const h of n.eav.values())for(const c of h.values())a.push(...Bt(c,r))}default:return gt(n.eav,3)}}function Wn(n,t){return kn(n,e=>{t.forEach(r=>{$n(e,r)})})}function Jn(n){return typeof n=="string"&&n.startsWith("?")}function Vn(n,t,e){if(e.hasOwnProperty(n)){const r=e[n];return nn(r,t,e)}return Object.assign(Object.assign({},e),{[n]:t})}function Ce(n,t,e){return n===t?e:null}function zn(n,t,e){const{in:r}=n;return r&&r.includes(t)?e:null}function Yn(n){switch(typeof n){case"string":return n.startsWith("?")?Vn:Ce;case"object":return zn;default:return Ce}}function nn(n,t,e){return e?Yn(n)(n,t,e):null}function Kn(n,t,e){return n.reduce((r,i,o)=>{const u=t[o];return nn(i,u,r)},e)}function Hn(n,t,e){return Xn(n,t,e).map(r=>Kn(t,r,e)).filter(r=>r)}function Qn(n,t,e){return t.or?t.or.patterns.flatMap(r=>se(n,r,e)):t.and?t.and.patterns.reduce((r,i)=>se(n,i,r),e):e.flatMap(r=>Hn(n,t,r))}function se(n,t,e=[{}]){return t.reduce((r,i)=>Qn(n,i,r),e)}function we(n,t){return Array.isArray(t)?t.map(e=>we(n,e)):Jn(t)?n[t]:t}function Gn(n,{find:t,where:e}){return se(n,e).map(i=>we(i,t))}function Xn(n,t,e){return qn(n,we(e,t))}let Dt;const Zn=new Uint8Array(16);function tr(){if(!Dt&&(Dt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Dt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Dt(Zn)}const G=[];for(let n=0;n<256;++n)G.push((n+256).toString(16).slice(1));function er(n,t=0){return G[n[t+0]]+G[n[t+1]]+G[n[t+2]]+G[n[t+3]]+"-"+G[n[t+4]]+G[n[t+5]]+"-"+G[n[t+6]]+G[n[t+7]]+"-"+G[n[t+8]]+G[n[t+9]]+"-"+G[n[t+10]]+G[n[t+11]]+G[n[t+12]]+G[n[t+13]]+G[n[t+14]]+G[n[t+15]]}const nr=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Me={randomUUID:nr};function rr(n,t,e){if(Me.randomUUID&&!t&&!n)return Me.randomUUID();n=n||{};const r=n.random||(n.rng||tr)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,er(r)}function Te(n){const t=n.replace(/-/g,""),e=[];for(let r=0;r<t.length;r+=2)e.push(parseInt(t.substring(r,r+2),16));return e}function ir(n,t){for(let e=0;e<n.length;e++){if(n[e]<t[e])return-1;if(n[e]>t[e])return 1}return 0}function Pe(n,t){return ir(Te(n),Te(t))}function Z(){return rr()}function ue(n,t,e){return new Proxy({},{get:(r,i)=>i==="__ops"?e:o=>ue(n,t,[...e,[i,n,t,o]])})}function ae(n){return n.startsWith("lookup__")}function rn(n){const[t,e,...r]=n.split("__");return[e,JSON.parse(r.join("__"))]}function or(n){return new Proxy({},{get(t,e){return ae(e)?ue(n,rn(e),[]):ue(n,e,[])}})}function on(){return new Proxy({},{get(n,t){return or(t)}})}on();function sr(n){return n.__ops}function ur(n,t){const{attrIdMap:e,refSwapAttrIds:r}=n,i=[];for(const u of t){const a=e[u];if(a)i.push(a);else if(Array.isArray(u)&&u.length==2&&e[u[0]]){const[h,c]=u;i.push([e[h],c])}else i.push(u)}const[o]=t;if((o==="add-triple"||o==="retract-triple")&&r.has(t[2])){const u=i[1];i[1]=i[3],i[3]=u}return i}function tt(n,t,e){return Object.values(n).find(r=>{const[i,o,u]=r["forward-identity"];return o===t&&u===e})}function At(n,t,e){return Object.values(n).find(r=>{const i=r["reverse-identity"];if(!i)return!1;const[o,u,a]=i;return u===t&&a===e})}function ar(n){if(Array.isArray(n))return n;const t=Object.entries(n);if(t.length!==1)throw new Error("lookup must be an object with a single unique attr and value.");return t[0]}function sn(n,t,e){return e.indexOf(".")!==-1&&!tt(n,t,e)}function un(n){const[t,e,...r]=n.split(".");if(r.length>0||e!=="id")throw new Error(`${n} is not a valid lookup attribute.`);return t}function cr(n,t,e){if(!sn(n,t,e))return tt(n,t,e);const r=un(e),i=tt(n,t,r);if(i&&i["value-type"]!=="ref")throw new Error(`${e} does not reference a valid link attribute.`);return i}function an(n){return typeof n=="string"&&!ae(n)?null:typeof n=="string"&&ae(n)?rn(n):ar(n)}function ot(n,t,e){const r=an(e);if(r===null)return e;const[i,o]=r,u=cr(n,t,i);if(!u||!u["unique?"])throw new Error(`${i} is not a unique attribute.`);return[u.id,o]}function fr(n,[t,e,r]){return Object.entries(r).flatMap(([o,u])=>{const a=Array.isArray(u)?u:[u],h=tt(n,t,o),c=At(n,t,o);return a.map(d=>h?["add-triple",ot(n,t,e),h.id,ot(n,h["reverse-identity"][1],d)]:["add-triple",ot(n,c["forward-identity"][1],d),c.id,ot(n,t,e)])})}function dr(n,[t,e,r]){return Object.entries(r).flatMap(([o,u])=>{const a=Array.isArray(u)?u:[u],h=tt(n,t,o),c=At(n,t,o);return a.map(d=>h?["retract-triple",ot(n,t,e),h.id,ot(n,h["reverse-identity"][1],d)]:["retract-triple",ot(n,c["forward-identity"][1],d),c.id,ot(n,t,e)])})}function lr(n,[t,e,r]){const i=ot(n,t,e);return[["id",ot(n,t,e)]].concat(Object.entries(r)).map(([u,a])=>{const h=tt(n,t,u);return["add-triple",i,h.id,a]})}function hr(n,[t,e]){return[["delete-entity",ot(n,t,e)]]}function pr(n,[t,e,r]){const i=ot(n,t,e),o=Object.entries(r).map(([a,h])=>{const c=tt(n,t,a),d=Ge(h,void 0,null);return["deep-merge-triple",i,c.id,d]});return[["add-triple",i,tt(n,t,"id").id,i]].concat(o)}function gr(n,[t,...e]){switch(t){case"merge":return pr(n,e);case"update":return lr(n,e);case"link":return fr(n,e);case"unlink":return dr(n,e);case"delete":return hr(n,e);default:throw new Error(`unsupported action ${t}`)}}function Le(n,t,e){const r=Z(),o=[Z(),n,t];return Object.assign({id:r,"forward-identity":o,"value-type":"blob",cardinality:"one","unique?":!1,"index?":!1,isUnsynced:!0},e||{})}function Re(n,t,e){const r=Z(),i=Z(),o=Z();return Object.assign({id:r,"forward-identity":[i,n,t],"reverse-identity":[o,t,n],"value-type":"ref",cardinality:"many","unique?":!1,"index?":!1,isUnsynced:!0},e||{})}const yr=new Set(["update","merge","link","unlink"]),vr=new Set(["link","unlink"]),br=new Set(["update","merge"]),_r=new Set(["link","unlink","update","merge","delete"]),cn={"unique?":!0,"index?":!0},wr=Object.assign(Object.assign({},cn),{cardinality:"one"});function mr(n,t){const[e,r,i]=[new Set,Object.assign({},n),[]];function o(a){r[a.id]=a,i.push(["add-attr",a]),e.add(a.id)}function u(a){a!=null&&a.isUnsynced&&!e.has(a.id)&&(i.push(["add-attr",a]),e.add(a.id))}for(const a of t){const[h,c,d,_]=a;if(_r.has(h)){const U=an(d);if(U){const L=U[0];if(sn(r,c,L)){const A=un(L),x=tt(r,c,A),w=At(r,c,A);!x&&!w&&o(Re(c,A,wr)),u(x),u(w)}else{const A=tt(r,c,L);A||o(Le(c,L,cn)),u(A)}}}}for(const a of t){const[h,c,d,_]=a;if(yr.has(h)){const U=Object.keys(_);U.push("id");for(const L of U){const A=tt(r,c,L);if(u(A),br.has(h)&&(A||o(Le(c,L))),vr.has(h)){const x=At(r,c,L);!A&&!x&&o(Re(c,L)),u(x)}}}}return[r,i]}function Sr(n,t){const r=(Array.isArray(t)?t:[t]).flatMap(a=>sr(a)),[i,o]=mr(n,r),u=r.flatMap(a=>gr(i,a));return[...o,...u]}let Ar=0;function Vt(n){return Kt(`_${n}`,Ar++)}function Kt(n,t){return`?${n}-${t}`}class Ct extends Error{constructor(t){super(t),this.name="AttrNotFoundError"}}function Or(n,t){const e=Object.values(n.attrs).find(r=>{var i;return r["primary?"]&&((i=r["forward-identity"])===null||i===void 0?void 0:i[1])===t});return e||tt(n.attrs,t,"id")}function Ir(n,t){const e=Or(n,t);if(!e)throw new Ct(`Could not find id attr for ${t}`);return e}function Be(n,t,e,r){return[Er(n,t,e,r),jr(n,e,r)]}function Er(n,t,e,r){return[n(e,r),Ir(t,e).id,n(e,r),Vt("time")]}function jr(n,t,e){return[n(t,e),n("attr",e),n("val",e),n("time",e)]}function xr(n,t,e){return n.map(r=>r===t?e:r)}function fn(n,t,e,r,i){const o=tt(t.attrs,e,i),u=At(t.attrs,e,i),a=o||u;if(!a)throw new Ct(`Could not find attr for ${[e,i]}`);if(a["value-type"]!=="ref")throw new Error(`Attr ${a.id} is not a ref`);const[h,c]=a["forward-identity"],[d,_]=a["reverse-identity"],U=r+1,L=o?[n(c,r),a.id,n(_,U),Vt("time")]:[n(c,U),a.id,n(_,r),Vt("time")];return[o?_:c,U,L,a,!!o]}function kr(n,t,e,r,i,o){const u=tt(t.attrs,e,i);if(!u)throw new Ct(`No attr for etype = ${e} label = ${i} value-label`);return[n(e,r),u.id,o,Vt("time")]}function Ur(n,t,e,r,i){const[o,u,a]=i.reduce((h,c)=>{const[d,_,U]=h,[L,A,x]=fn(n,t,d,_,c);return[L,A,[...U,x]]},[e,r,[]]);return[o,u,a]}function Cr(n,t,e,r,i,o){const u=i.slice(0,i.length-1),a=i[i.length-1],[h,c,d]=Ur(n,t,e,r,u),_=kr(n,t,h,c,a,o);return d.concat([_])}function Mr(n,t){return t?[t].concat(n):n}function Tr([n,t]){return n==="or"&&Array.isArray(t)}function Pr([n,t]){return n==="and"&&Array.isArray(t)}function Lr(n,t,e){return(r,i)=>r==t?n(r,i):`${n(r,i)}-${e}`}function De(n,t,e,r,i,o){const u=o.map((h,c)=>{const d=Lr(n,r,c);return dn(d,e,r,i,h)}),a=n(r,i);return{[t]:{patterns:u,joinSym:a}}}function dn(n,t,e,r,i){return Object.entries(i).flatMap(([o,u])=>{if(Tr([o,u]))return De(n,"or",t,e,r,u);if(Pr([o,u]))return De(n,"and",t,e,r,u);const a=o.split(".");return Cr(n,t,e,r,a,u)})}function Rr(n,t,e,r){const i=Kt;return r?dn(i,n,t,e,r).concat(Be(i,n,t,e)):Be(i,n,t,e)}function Br(n,t,e){return[n(t,e),n("attr",e),n("val",e),n("time",e)]}function Dr(n,t,e,r,i,o){const[u,a,h,c,d]=fn(n,t,e,r,i),_=xr(h,n(e,r),o);return[u,a,_,c,d]}function Nr(n,t,{etype:e,level:r,form:i},o){const u=Object.keys(i).filter(a=>a!=="$");return u.length?Object.entries(o).map(([a,h])=>u.map(d=>{var _,U,L;const A=!!(t.cardinalityInference&&(!((L=(U=(_=t.linkIndex)===null||_===void 0?void 0:_[e])===null||U===void 0?void 0:U[d])===null||L===void 0)&&L.isSingular));try{const[x,w,k]=Dr(n,t,e,r,d,a),C=ln(t,{etype:x,level:w,form:i[d],join:k}),E=A?C[0]:C;return{[d]:E}}catch(x){if(x instanceof Ct)return{[d]:A?void 0:[]};throw x}}).reduce((d,_)=>Object.assign(Object.assign({},d),_),h)):Object.values(o)}function $r(n,t){const e=n[t];return e["value-type"]==="ref"&&e["forward-identity"][2]!=="id"}function Ne(n,t){switch(n){case"asc":switch(t){case"number":return(e,r)=>e<r;case"uuid":return(e,r)=>Pe(e,r)===-1}case"desc":switch(t){case"number":return(e,r)=>e>r;case"uuid":return(e,r)=>Pe(e,r)===1}}}function Fr(n,t,[e,r,i,o]){return Ne(t,"number")(o,n[3])||o===n[3]&&Ne(t,"uuid")(e,n[0])}function qr(n,t,e,r,i){const o=r==null?void 0:r["start-cursor"],u=[],a=Gn(n,i).sort((h,c)=>{const d=h[3],_=c[3];return e==="desc"?_-d:d-_}).reduce((h,c)=>{const[d,_,U]=c;if($r(n.attrs,_))return h;const L=n.attrs[_],[A,x,w]=L["forward-identity"];return x!==t||(o&&_===o[1]&&Fr(o,e,c)&&u.push(d),h[d]=h[d]||{},h[d][w]=U),h},{});for(const h of u)delete a[h];return a}function Wr(n){var t;const e=(t=n.$)===null||t===void 0?void 0:t.order;return e&&e[Object.keys(e)[0]]||"asc"}function Jr(n,{etype:t,level:e,form:r,join:i,pageInfo:o}){var u,a,h,c,d,_,U;const L=((u=r.$)===null||u===void 0?void 0:u.limit)||((a=r.$)===null||a===void 0?void 0:a.first)||((h=r.$)===null||h===void 0?void 0:h.last),A=(c=r.$)===null||c===void 0?void 0:c.offset,x=(d=r.$)===null||d===void 0?void 0:d.before,w=(_=r.$)===null||_===void 0?void 0:_.after;if((A||x||w)&&(!o||!o["start-cursor"]))return[];const k=Mr(Rr(n,t,e,(U=r.$)===null||U===void 0?void 0:U.where),i),C=Br(Kt,t,e),E=qr(n,t,Wr(r),o,{where:k,find:C});if(L!=null){const j=Object.entries(E);return j.length<=L?E:Object.fromEntries(j.slice(0,L))}return E}function Vr(n,t){try{return Jr(n,t)}catch(e){if(e instanceof Ct)return{};throw e}}function ln(n,t){const e=Vr(n,t);return Nr(Kt,n,t,e)}function zr(n){const t={};for(const[e,r]of Object.entries(n))t[e]={startCursor:r["start-cursor"],endCursor:r["end-cursor"],hasNextPage:r["has-next-page?"],hasPreviousPage:r["has-previous-page?"]};return t}function Yr({store:n,pageInfo:t,aggregate:e},r){const o={data:Object.keys(r).reduce((u,a)=>(e!=null&&e[a]||(u[a]=ln(n,{etype:a,form:r[a],level:0,pageInfo:t==null?void 0:t[a]})),u),{})};return t&&(o.pageInfo=zr(t)),e&&(o.aggregate=e),o}var $e=function(n,t,e,r){function i(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function a(d){try{c(r.next(d))}catch(_){u(_)}}function h(d){try{c(r.throw(d))}catch(_){u(_)}}function c(d){d.done?o(d.value):i(d.value).then(a,h)}c((r=r.apply(n,t||[])).next())})};class hn{constructor(t){this.dbName=t,this._storeName="kv",this._dbPromise=this._init()}_init(){return new Promise((t,e)=>{const r=indexedDB.open(this.dbName,1);r.onerror=i=>{e(i)},r.onsuccess=i=>{t(i.target.result)},r.onupgradeneeded=i=>{i.target.result.createObjectStore(this._storeName)}})}getItem(t){return $e(this,void 0,void 0,function*(){const e=yield this._dbPromise;return new Promise((r,i)=>{const a=e.transaction([this._storeName],"readonly").objectStore(this._storeName).get(t);a.onerror=h=>{i(h)},a.onsuccess=h=>{a.result?r(a.result):r(null)}})})}setItem(t,e){return $e(this,void 0,void 0,function*(){const r=yield this._dbPromise;return new Promise((i,o)=>{const h=r.transaction([this._storeName],"readwrite").objectStore(this._storeName).put(e,t);h.onerror=c=>{o(c)},h.onsuccess=c=>{i()}})})}}var Kr=function(n,t,e,r){function i(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function a(d){try{c(r.next(d))}catch(_){u(_)}}function h(d){try{c(r.throw(d))}catch(_){u(_)}}function c(d){d.done?o(d.value):i(d.value).then(a,h)}c((r=r.apply(n,t||[])).next())})};class pn{static getIsOnline(){return Kr(this,void 0,void 0,function*(){return navigator.onLine})}static listen(t){const e=()=>{t(!0)},r=()=>{t(!1)};return addEventListener("online",e),addEventListener("offline",r),()=>{removeEventListener("online",e),removeEventListener("offline",r)}}}var Hr=function(n,t,e,r){function i(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function a(d){try{c(r.next(d))}catch(_){u(_)}}function h(d){try{c(r.throw(d))}catch(_){u(_)}}function c(d){d.done?o(d.value):i(d.value).then(a,h)}c((r=r.apply(n,t||[])).next())})};function pt(n,t){return Hr(this,void 0,void 0,function*(){const e=yield fetch(n,t),r=yield e.json();return e.status===200?Promise.resolve(r):Promise.reject({status:e.status,body:r})})}var Mt=function(n,t,e,r){function i(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function a(d){try{c(r.next(d))}catch(_){u(_)}}function h(d){try{c(r.throw(d))}catch(_){u(_)}}function c(d){d.done?o(d.value):i(d.value).then(a,h)}c((r=r.apply(n,t||[])).next())})};function Qr({apiURI:n,appId:t,email:e}){return pt(`${n}/runtime/auth/send_magic_code`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":t,email:e})})}function Gr(n){return Mt(this,arguments,void 0,function*({apiURI:t,appId:e,email:r,code:i}){return yield pt(`${t}/runtime/auth/verify_magic_code`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":e,email:r,code:i})})})}function Xr(n){return Mt(this,arguments,void 0,function*({apiURI:t,appId:e,refreshToken:r}){return yield pt(`${t}/runtime/auth/verify_refresh_token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":e,"refresh-token":r})})})}function Fe(n){return Mt(this,arguments,void 0,function*({apiURI:t,appId:e,code:r,codeVerifier:i}){return yield pt(`${t}/runtime/oauth/token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:e,code:r,code_verifier:i})})})}function Zr(n){return Mt(this,arguments,void 0,function*({apiURI:t,appId:e,nonce:r,idToken:i,clientName:o,refreshToken:u}){return yield pt(`${t}/runtime/oauth/id_token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:e,nonce:r,id_token:i,client_name:o,refresh_token:u})})})}function ti(n){return Mt(this,arguments,void 0,function*({apiURI:t,appId:e,refreshToken:r}){return yield pt(`${t}/runtime/signout`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:e,refresh_token:r})})})}var Ht=function(n,t,e,r){function i(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function a(d){try{c(r.next(d))}catch(_){u(_)}}function h(d){try{c(r.throw(d))}catch(_){u(_)}}function c(d){d.done?o(d.value):i(d.value).then(a,h)}c((r=r.apply(n,t||[])).next())})};function ei(n){return Ht(this,arguments,void 0,function*({apiURI:t,appId:e,fileName:r,refreshToken:i,metadata:o={}}){const{data:u}=yield pt(`${t}/storage/signed-upload-url`,{method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${i}`},body:JSON.stringify({app_id:e,filename:r})});return u})}function ni(n,t){return Ht(this,void 0,void 0,function*(){return(yield fetch(n,{method:"PUT",body:t,headers:{"Content-Type":t.type}})).ok})}function ri(n){return Ht(this,arguments,void 0,function*({apiURI:t,appId:e,path:r,refreshToken:i}){const{data:o}=yield pt(`${t}/storage/signed-download-url?app_id=${e}&filename=${encodeURIComponent(r)}`,{method:"GET",headers:{"content-type":"application/json",authorization:`Bearer ${i}`}});return o})}function ii(n){return Ht(this,arguments,void 0,function*({apiURI:t,appId:e,path:r,refreshToken:i}){const{data:o}=yield pt(`${t}/storage/files?app_id=${e}&filename=${encodeURIComponent(r)}`,{method:"DELETE",headers:{"content-type":"application/json",authorization:`Bearer ${i}`}});return o})}function qe(n,t){if(!t)return n;const e={};return t.forEach(r=>{e[r]=n[r]}),e}function oi(n,t){var e,r;const i={peers:{}};if(t&&"user"in t?t.user:!0){const u=qe((e=n.user)!==null&&e!==void 0?e:{},t==null?void 0:t.keys);i.user=u}for(const u of Object.keys((r=n.peers)!==null&&r!==void 0?r:{})){const a=(t==null?void 0:t.peers)===void 0,h=Array.isArray(t==null?void 0:t.peers)&&(t==null?void 0:t.peers.includes(u));if(a||h){const c=qe(n.peers[u],t==null?void 0:t.keys);i.peers[u]=c}}return i}function si(n,t){if(n.isLoading!==t.isLoading||n.error!==t.error||(n.user||t.user)&&(!n.user||!t.user||!ke(n.user,t.user))||!He(n.peers,t.peers))return!0;for(const r of Object.keys(n.peers))if(!ke(n.peers[r],t.peers[r]))return!0;return!1}class ui{constructor(){this.promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}resolve(t){this._resolve(t)}reject(t){this._reject(t)}}var We=function(n,t,e,r){function i(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function a(d){try{c(r.next(d))}catch(_){u(_)}}function h(d){try{c(r.throw(d))}catch(_){u(_)}}function c(d){d.done?o(d.value):i(d.value).then(a,h)}c((r=r.apply(n,t||[])).next())})};class Je{constructor(t,e,r,i,o=a=>JSON.stringify(a),u=a=>JSON.parse(a)){this._persister=t,this._key=e,this._onMerge=i,this._loadedCbs=[],this._isLoading=!0,this.currentValue=r,this.toJSON=o,this.fromJSON=u,this._load()}_load(){return We(this,void 0,void 0,function*(){const t=this.fromJSON(yield this._persister.getItem(this._key));this._isLoading=!1,this._onMerge(t,this.currentValue);for(const e of this._loadedCbs)e()})}waitForLoaded(){return We(this,void 0,void 0,function*(){if(!this._isLoading)return;yield new Promise(e=>{this._loadedCbs.push(e)})})}set(t,e){this.currentValue=t(this.currentValue),this._isLoading||setTimeout(()=>{this._persister.setItem(this._key,this.toJSON(this.currentValue)),e&&e()},0)}}function gn(n,t=[]){n.forEach(e=>{const{data:r}=e,{"datalog-result":i}=r,{"join-rows":o}=i;for(const u of o)for(const a of u)t.push(a);gn(e["child-nodes"],t)})}function Ve(n){const t=[];return gn(n,t),t}function ai(n,t){return t instanceof Map?{__type:"m",entries:[...t.entries()]}:t}function ci(n,t){return t&&typeof t=="object"&&t.__type==="m"?new Map(t.entries):t}function fi(n){return JSON.stringify(n,ai)}function di(n){return JSON.parse(n,ci)}function li(n){return Object.values(n.links).reduce((t,e)=>{var r,i,o,u;return(r=t[o=e.forward.on])!==null&&r!==void 0||(t[o]={}),t[e.forward.on][e.forward.label]={isForward:!0,isSingular:e.forward.has==="one",link:e},(i=t[u=e.reverse.on])!==null&&i!==void 0||(t[u]={}),t[e.reverse.on][e.reverse.label]={isForward:!1,isSingular:e.reverse.has==="one",link:e},t},{})}var X=function(n,t,e,r){function i(o){return o instanceof e?o:new e(function(u){u(o)})}return new(e||(e=Promise))(function(o,u){function a(d){try{c(r.next(d))}catch(_){u(_)}}function h(d){try{c(r.throw(d))}catch(_){u(_)}}function c(d){d.done?o(d.value):i(d.value).then(a,h)}c((r=r.apply(n,t||[])).next())})};const yt={CONNECTING:"connecting",OPENED:"opened",AUTHENTICATED:"authenticated",CLOSED:"closed",ERRORED:"errored"},hi=1,pi={apiURI:"https://api.instantdb.com",websocketURI:"wss://api.instantdb.com/runtime/session"},te="_instant_oauth_redirect",ee="currentUser";function gi(){return typeof window<"u"||typeof chrome<"u"}class yi{constructor(t,e=hn,r=pn){this._isOnline=!0,this._isShutdown=!1,this.status=yt.CONNECTING,this.queryCbs={},this.authCbs=[],this.attrsCbs=[],this.mutationErrorCbs=[],this.mutationDeferredStore=new Map,this._reconnectTimeoutId=null,this._reconnectTimeoutMs=0,this._localIdPromises={},this._errorMessage=null,this._oauthCallbackResponse=null,this._linkIndex=null,this._presence={},this._broadcastSubs={},this._currentUserCached={isLoading:!0,error:void 0,user:void 0},this._onMergeQuerySubs=(i,o)=>{const u=i||{},a=Object.assign({},o);Object.entries(o).forEach(([c,d])=>{var _;const U=(_=u==null?void 0:u[c])===null||_===void 0?void 0:_.result,L=d.result;U&&!L&&(a[c].result=U)}),Object.keys(u).filter(c=>!o[c]).slice(0,10).forEach(c=>{a[c]=u[c]}),this.querySubs.set(c=>a),this.notifyAll()},this._onMergePendingMutations=(i,o)=>{const u=new Map([...i.entries(),...o.entries()]);this.pendingMutations.set(h=>u),this._rewriteMutations(this.attrs,i).forEach((h,c)=>{!o.has(c)&&!h["tx-id"]&&this._sendMutation(c,h)})},this.getPreviousResult=i=>{var o,u,a;const h=_t(i),c=this._errorMessage,d=(a=(u=(o=this.querySubs)===null||o===void 0?void 0:o.currentValue)===null||u===void 0?void 0:u[h])===null||a===void 0?void 0:a.result;if(c)return{error:c};if(d)return this.dataForResult(i,d)},this.notifyOne=i=>{const o=this.queryCbs[i]||[];if(!o)return;const u=this._errorMessage;if(u){o.forEach(_=>_({error:u}));return}const{q:a,result:h,iqlResult:c}=this.querySubs.currentValue[i]||{};if(!h)return;const d=this.dataForResult(a,h);$t(d.data,c)||(this.querySubs.currentValue[i].iqlResult=h.data,o.forEach(_=>_(d)))},this.notifyQueryError=(i,o)=>{(this.queryCbs[i]||[]).forEach(a=>a({error:o}))},this.pushTx=i=>{try{const o=Sr(this.optimisticAttrs(),i);return this.pushOps(o)}catch(o){return this.pushOps([],o)}},this.pushOps=(i,o)=>{const u=Z(),a={op:"transact","tx-steps":i,error:o};this.pendingMutations.set(c=>(c.set(u,a),c));const h=new ui;return this.mutationDeferredStore.set(u,h),this._sendMutation(u,a),this.notifyAll(),h.promise},this._wsOnOpen=()=>{jt.info("[socket] connected"),this._setStatus(yt.OPENED),this.getCurrentUser().then(i=>{var o;this._trySend(Z(),{op:"init","app-id":this.config.appId,"refresh-token":(o=i.user)===null||o===void 0?void 0:o.refresh_token,"__admin-token":this.config.__adminToken})})},this._wsOnMessage=i=>{this._handleReceive(JSON.parse(i.data.toString()))},this._wsOnError=i=>{jt.error("[socket] error: ",i)},this._wsOnClose=()=>{if(this._setStatus(yt.CLOSED),this._isShutdown){jt.info("[socket-close] socket has been shut down and will not reconnect");return}jt.info("[socket-close] scheduling reconnect",this._reconnectTimeoutMs),setTimeout(()=>{if(this._reconnectTimeoutMs=Math.min(this._reconnectTimeoutMs+1e3,1e4),!this._isOnline){jt.info("[socket-close] we are offline, no need to start socket");return}this._startSocket()},this._reconnectTimeoutMs)},this.config=Object.assign(Object.assign({},pi),t),this.config.schema&&(this._linkIndex=li(this.config.schema)),gi()&&(typeof BroadcastChannel=="function"&&(this._broadcastChannel=new BroadcastChannel("@instantdb"),this._broadcastChannel.addEventListener("message",i=>X(this,void 0,void 0,function*(){var o;if(((o=i.data)===null||o===void 0?void 0:o.type)==="auth"){const u=yield this.getCurrentUser();this.updateUser(u.user)}}))),this._oauthCallbackResponse=this._oauthLoginInit(),this._initStorage(e),this.getCurrentUser(),r.getIsOnline().then(i=>{this._isOnline=i,this._startSocket(),r.listen(o=>{o!==this._isOnline&&(this._isOnline=o,this._isOnline&&this._startSocket())})}))}_initStorage(t){this._persister=new t(`instant_${this.config.appId}_4`),this.querySubs=new Je(this._persister,"querySubs",{},this._onMergeQuerySubs,fi,di),this.pendingMutations=new Je(this._persister,"pendingMutations",new Map,this._onMergePendingMutations,e=>JSON.stringify([...e.entries()]),e=>new Map(JSON.parse(e)))}_finishTransaction(t,e,r,i){const o=this.mutationDeferredStore.get(r);this.mutationDeferredStore.delete(r),!o&&!t&&console.error("Mutation failed",Object.assign({status:e,clientId:r},i)),o&&(t?o.resolve({status:e,clientId:r}):o.reject(Object.assign({status:e,clientId:r},i)))}_setStatus(t,e){this.status=t,this._errorMessage=e}_cleanPendingMutations(t){this.pendingMutations.set(e=>{const r=new Map(e);return[...e.entries()].forEach(([i,o])=>{o["tx-id"]<=t&&r.delete(i)}),r})}_handleReceive(t){var e,r,i,o;const u=!!this.config.schema&&("cardinalityInference"in this.config?!!this.config.cardinalityInference:!0);switch(t.op){case"init-ok":this._setStatus(yt.AUTHENTICATED),this._reconnectTimeoutMs=0,this._setAttrs(t.attrs),this._flushPendingMessages(),this._sessionId=t["session-id"];break;case"add-query-ok":const{q:a,result:h,"processed-tx-id":c}=t;this._cleanPendingMutations(c);const d=_t(a),_=(r=(e=h==null?void 0:h[0])===null||e===void 0?void 0:e.data)===null||r===void 0?void 0:r["page-info"],U=(o=(i=h==null?void 0:h[0])===null||i===void 0?void 0:i.data)===null||o===void 0?void 0:o.aggregate,L=Ve(h),A=Ue(this.attrs,L,u,this._linkIndex);this.querySubs.set(M=>(M[d].result={store:A,pageInfo:_,aggregate:U},M)),this.notifyOne(d);break;case"refresh-ok":const{computations:x,attrs:w,"processed-tx-id":k}=t;this._cleanPendingMutations(k),this._setAttrs(w);const C=x.map(M=>{var F,V,J,q;const st=M["instaql-query"],at=M["instaql-result"],vt=_t(st),Tt=Ve(at),It=Ue(this.attrs,Tt,u,this._linkIndex),Et=(V=(F=at==null?void 0:at[0])===null||F===void 0?void 0:F.data)===null||V===void 0?void 0:V["page-info"],Pt=(q=(J=at==null?void 0:at[0])===null||J===void 0?void 0:J.data)===null||q===void 0?void 0:q.aggregate;return{hash:vt,store:It,pageInfo:Et,aggregate:Pt}});C.forEach(({hash:M,store:F,pageInfo:V,aggregate:J})=>{this.querySubs.set(q=>(q[M].result={store:F,pageInfo:V,aggregate:J},q))}),C.forEach(({hash:M})=>{this.notifyOne(M)});break;case"transact-ok":const{"client-event-id":E,"tx-id":j}=t,v=this._rewriteMutations(this.attrs,this.pendingMutations.currentValue).get(E);if(!v)break;const S=Object.assign(Object.assign({},v),{"tx-id":j});this.pendingMutations.set(M=>(M.set(E,S),M)),this._finishTransaction(!0,"synced",E);const l=v["tx-steps"].filter(([M,...F])=>M==="add-attr").map(([M,F])=>F).concat(Object.values(this.attrs));this._setAttrs(l);break;case"refresh-presence":const g=t["room-id"];this._setPresencePeers(g,t.data),this._notifyPresenceSubs(g);break;case"server-broadcast":const f=t["room-id"],b=t.topic;this._notifyBroadcastSubs(f,b,t);break;case"join-room-ok":const m=t["room-id"],D=this._presence[m];D&&(D.isLoading=!1),this._notifyPresenceSubs(m);break;case"join-room-error":const B=t["room-id"],N=this._presence[B];N&&(N.error=t.error),this._notifyPresenceSubs(B);break;case"error":this._handleReceiveError(t);break}}_handleReceiveError(t){var e,r,i;const o=t["client-event-id"];if(this.pendingMutations.currentValue.get(o)){this.pendingMutations.set(_=>(_.delete(o),_)),this.notifyAll(),this.notifyAttrsSubs(),this.notifyMutationErrorSubs(t);const d={message:t.message,hint:t.hint};this._finishTransaction(!1,"error",o,d);return}const a=t.q||((e=t["original-event"])===null||e===void 0?void 0:e.q);if(a){this.querySubs.set(d=>{const _=_t(a);return delete d[_],d}),this.notifyQueryError(_t(a),{message:t.message||"Uh-oh, something went wrong. Ping Joe & Stopa."});return}if(((r=t["original-event"])===null||r===void 0?void 0:r.op)==="init"){if(t.type==="record-not-found"&&((i=t.hint)===null||i===void 0?void 0:i["record-type"])==="app-user"){this.changeCurrentUser(null);return}const d={message:t.message||"Uh-oh, something went wrong. Ping Joe & Stopa."};this._setStatus(yt.ERRORED,d),this.notifyAll();return}const c=Object.assign({},t);delete c.message,delete c.hint,console.error(t.message,c),t.hint&&console.error(`This error comes with some debugging information. Here it is: 
`,t.hint)}_setAttrs(t){this.attrs=t.reduce((e,r)=>(e[r.id]=r,e),{}),this.notifyAttrsSubs()}subscribeQuery(t,e){const r=Z(),i=_t(t);this.queryCbs[i]=this.queryCbs[i]||[],this.queryCbs[i].push(e),this.querySubs.set(u=>(u[i]=u[i]||{q:t,result:null,eventId:r},u)),this._trySendAuthed(r,{op:"add-query",q:t});const o=this.getPreviousResult(t);return o&&e(o),()=>{this.queryCbs[i]=this.queryCbs[i].filter(u=>u!==e)}}_rewriteMutations(t,e){if(!t)return e;const r=h=>{const[c,d,_]=h["forward-identity"];return tt(t,d,_)},i=h=>{const[c,d,_]=h["forward-identity"];return At(t,d,_)},o={attrIdMap:{},refSwapAttrIds:new Set},u=h=>{const c=[];for(const d of h){const[_]=d;if(_==="add-attr"){const[L,A]=d,x=r(A);if(x){o.attrIdMap[A.id]=x.id;continue}if(A["value-type"]==="ref"){const w=i(A);if(w){o.attrIdMap[A.id]=w.id,o.refSwapAttrIds.add(A.id);continue}}}const U=ur(o,d);c.push(U)}return c},a=new Map;for(const[h,c]of e.entries())a.set(h,Object.assign(Object.assign({},c),{"tx-steps":u(c["tx-steps"])}));return a}optimisticAttrs(){var t;const e=[...this.pendingMutations.currentValue.values()].flatMap(a=>a["tx-steps"]),r=new Set(e.filter(([a,h])=>a==="delete-attr").map(([a,h])=>h)),i=[];for(const[a,h]of e)if(a==="add-attr")i.push(h);else if(a==="update-attr"&&h.id&&(!((t=this.attrs)===null||t===void 0)&&t[h.id])){const c=Object.assign(Object.assign({},this.attrs[h.id]),h);i.push(c)}const o=[...Object.values(this.attrs||{}),...i].filter(a=>!r.has(a.id));return Object.fromEntries(o.map(a=>[a.id,a]))}dataForResult(t,{store:e,pageInfo:r,aggregate:i}){const u=[...this._rewriteMutations(e.attrs,this.pendingMutations.currentValue).values()].flatMap(c=>c["tx-steps"]),a=Wn(e,u);return Yr({store:a,pageInfo:r,aggregate:i},t)}notifyAll(){Object.keys(this.queryCbs).forEach(t=>{this.notifyOne(t)})}shutdown(){this._isShutdown=!0,this._ws.close()}_sendMutation(t,e){if(e.error){this._finishTransaction(!1,"error",t,{error:e.error,message:e.error.message}),this.pendingMutations.set(i=>(i.delete(t),i));return}if(this.status!==yt.AUTHENTICATED){this._finishTransaction(!0,"enqueued",t);return}const r=Math.max(5e3,this.pendingMutations.currentValue.size*5e3);this._isOnline?(this._trySend(t,e),setTimeout(()=>{this._finishTransaction(!0,"pending",t)},3e3),setTimeout(()=>{if(!this._isOnline)return;const i=this.pendingMutations.currentValue.get(t);i&&!i["tx-id"]&&(this.pendingMutations.set(o=>(o.delete(t),o)),this._finishTransaction(!1,"timeout",t),console.error("mutation timed out",i))},r)):this._finishTransaction(!0,"enqueued",t)}_flushPendingMessages(){Object.keys(this.queryCbs).map(u=>this.querySubs.currentValue[u]).filter(u=>u).forEach(({eventId:u,q:a})=>{this._trySendAuthed(u,{op:"add-query",q:a})}),this._rewriteMutations(this.attrs,this.pendingMutations.currentValue).forEach((u,a)=>{u["tx-id"]||this._sendMutation(a,u)}),Object.keys(this._presence).forEach(u=>{this._trySendAuthed(Z(),{op:"join-room","room-id":u})}),Object.entries(this._presence).forEach(([u,{result:a}])=>{const h=a==null?void 0:a.user;h&&this._trySendAuthed(Z(),{op:"set-presence","room-id":u,data:h})})}_trySendAuthed(t,e){this.status===yt.AUTHENTICATED&&this._trySend(t,e)}_trySend(t,e){this._ws.readyState===hi&&this._ws.send(JSON.stringify(Object.assign({"client-event-id":t},e)))}_startSocket(){this._ws=new WebSocket(`${this.config.websocketURI}?app_id=${this.config.appId}`),this._ws.onopen=this._wsOnOpen,this._ws.onmessage=this._wsOnMessage,this._ws.onclose=this._wsOnClose}getLocalId(t){return X(this,void 0,void 0,function*(){const e=`localToken_${t}`,r=yield this._persister.getItem(e);if(r)return r;if(this._localIdPromises[e])return this._localIdPromises[e];const i=Z();return this._localIdPromises[e]=this._persister.setItem(e,i).then(()=>i),this._localIdPromises[e]})}_replaceUrlAfterOAuth(){if(typeof URL>"u")return;const t=new URL(window.location.href);if(t.searchParams.get(te)){const e=t.toString();t.searchParams.delete(te),t.searchParams.delete("code"),t.searchParams.delete("error");const r=t.pathname+(t.searchParams.size?"?"+t.searchParams:"")+t.hash;if(history.replaceState(history.state,"",r),typeof navigation=="object"&&typeof navigation.addEventListener=="function"&&typeof navigation.removeEventListener=="function"){let i=!1;const o=u=>{var a;i||(i=!0,navigation.removeEventListener("navigate",o),!u.userInitiated&&u.navigationType==="replace"&&((a=u.destination)===null||a===void 0?void 0:a.url)===e&&history.replaceState(history.state,"",r))};navigation.addEventListener("navigate",o)}}}_oauthLoginInit(){return X(this,void 0,void 0,function*(){var t,e,r,i;if(typeof window>"u"||typeof window.location>"u"||typeof URLSearchParams>"u")return null;const o=new URLSearchParams(window.location.search);if(!o.get(te))return null;const u=o.get("error");if(u)return this._replaceUrlAfterOAuth(),{error:{message:u}};const a=o.get("code");if(!a)return null;this._replaceUrlAfterOAuth();try{const{user:h}=yield Fe({apiURI:this.config.apiURI,appId:this.config.appId,code:a});return this.setCurrentUser(h),null}catch(h){return((t=h==null?void 0:h.body)===null||t===void 0?void 0:t.type)==="record-not-found"&&((r=(e=h==null?void 0:h.body)===null||e===void 0?void 0:e.hint)===null||r===void 0?void 0:r["record-type"])==="app-oauth-code"&&(yield this._hasCurrentUser())?null:{error:{message:((i=h==null?void 0:h.body)===null||i===void 0?void 0:i.message)||"Error logging in."}}}})}_waitForOAuthCallbackResponse(){return X(this,void 0,void 0,function*(){return yield this._oauthCallbackResponse})}__subscribeMutationErrors(t){return this.mutationErrorCbs.push(t),()=>{this.mutationErrorCbs=this.mutationErrorCbs.filter(e=>e!==t)}}subscribeAuth(t){this.authCbs.push(t);const e=this._currentUserCached;e.isLoading||t(this._currentUserCached);let r=!1;return this.getCurrentUser().then(i=>{r||$t(i,e)||t(i)}),()=>{r=!0,this.authCbs=this.authCbs.filter(i=>i!==t)}}subscribeAttrs(t){return this.attrsCbs.push(t),this.attrs&&t(this.attrs),()=>{this.attrsCbs=this.attrsCbs.filter(e=>e!==t)}}notifyAuthSubs(t){this.authCbs.forEach(e=>e(t))}notifyMutationErrorSubs(t){this.mutationErrorCbs.forEach(e=>e(t))}notifyAttrsSubs(){if(!this.attrs)return;const t=this.optimisticAttrs();this.attrsCbs.forEach(e=>e(t))}setCurrentUser(t){return X(this,void 0,void 0,function*(){yield this._persister.setItem(ee,JSON.stringify(t))})}getCurrentUserCached(){return this._currentUserCached}getCurrentUser(){return X(this,void 0,void 0,function*(){const t=yield this._waitForOAuthCallbackResponse();if(t!=null&&t.error){const i={error:t.error,user:void 0};return this._currentUserCached=Object.assign({isLoading:!1},i),i}const e=yield this._persister.getItem(ee),r={user:JSON.parse(e),error:void 0};return this._currentUserCached=Object.assign({isLoading:!1},r),r})}_hasCurrentUser(){return X(this,void 0,void 0,function*(){const t=yield this._persister.getItem(ee);return JSON.parse(t)!=null})}changeCurrentUser(t){return X(this,void 0,void 0,function*(){var e;const{user:r}=yield this.getCurrentUser();if(!$t(r,t)){yield this.setCurrentUser(t),this.updateUser(t);try{(e=this._broadcastChannel)===null||e===void 0||e.postMessage({type:"auth"})}catch(i){console.error("Error posting message to broadcast channel",i)}}})}updateUser(t){const e={error:void 0,user:t};this._currentUserCached=Object.assign({isLoading:!1},e),this.querySubs.set(r=>(Object.keys(r).forEach(i=>{delete r[i].result}),r)),this._reconnectTimeoutMs=0,this._ws.close(),this._oauthCallbackResponse=null,this.notifyAuthSubs(e)}sendMagicCode({email:t}){return Qr({apiURI:this.config.apiURI,appId:this.config.appId,email:t})}signInWithMagicCode(t){return X(this,arguments,void 0,function*({email:e,code:r}){const i=yield Gr({apiURI:this.config.apiURI,appId:this.config.appId,email:e,code:r});return this.changeCurrentUser(i.user),i})}signInWithCustomToken(t){return X(this,void 0,void 0,function*(){const e=yield Xr({apiURI:this.config.apiURI,appId:this.config.appId,refreshToken:t});this.changeCurrentUser(e.user)})}signOut(){return X(this,void 0,void 0,function*(){var t;const e=yield this.getCurrentUser(),r=(t=e==null?void 0:e.user)===null||t===void 0?void 0:t.refresh_token;if(r)try{yield ti({apiURI:this.config.apiURI,appId:this.config.appId,refreshToken:r})}catch{}this.changeCurrentUser(null)})}createAuthorizationURL({clientName:t,redirectURL:e}){const{apiURI:r,appId:i}=this.config;return`${r}/runtime/oauth/start?app_id=${i}&client_name=${t}&redirect_uri=${e}`}exchangeCodeForToken(t){return X(this,arguments,void 0,function*({code:e,codeVerifier:r}){const i=yield Fe({apiURI:this.config.apiURI,appId:this.config.appId,code:e,codeVerifier:r});return this.changeCurrentUser(i.user),i})}issuerURI(){const{apiURI:t,appId:e}=this.config;return`${t}/runtime/${e}`}signInWithIdToken(t){return X(this,arguments,void 0,function*({idToken:e,clientName:r,nonce:i}){var o;const u=yield this.getCurrentUser(),a=(o=u==null?void 0:u.user)===null||o===void 0?void 0:o.refresh_token,h=yield Zr({apiURI:this.config.apiURI,appId:this.config.appId,idToken:e,clientName:r,nonce:i,refreshToken:a});return this.changeCurrentUser(h.user),h})}joinRoom(t){return this._trySendAuthed(Z(),{op:"join-room","room-id":t}),()=>{this._cleanupRoom(t)}}_cleanupRoom(t){var e,r,i;!(!((r=(e=this._presence[t])===null||e===void 0?void 0:e.handlers)===null||r===void 0)&&r.length)&&!Object.keys((i=this._broadcastSubs[t])!==null&&i!==void 0?i:{}).length&&(delete this._presence[t],delete this._broadcastSubs[t],this._trySendAuthed(Z(),{op:"leave-room","room-id":t}))}getPresence(t,e,r={}){const i=this._presence[e];return!i||!i.result?null:Object.assign(Object.assign({},oi(i.result,r)),{isLoading:i.isLoading,error:i.error})}publishPresence(t,e,r){var i,o;const u=Object.assign(Object.assign({},(o=(i=this._presence[e])===null||i===void 0?void 0:i.result)===null||o===void 0?void 0:o.user),r);this._trySendAuthed(Z(),{op:"set-presence","room-id":e,data:u}),this._presence[e]=this._presence[e]||{},this._presence[e].result=this._presence[e].result||{},this._presence[e].result.user=u,this._notifyPresenceSubs(e)}subscribePresence(t,e,r,i){const o=this.joinRoom(e),u=Object.assign(Object.assign({},r),{roomId:e,cb:i,prev:null});return this._presence[e]=this._presence[e]||{},this._presence[e].isLoading=!0,this._presence[e].handlers=this._presence[e].handlers||[],this._presence[e].handlers.push(u),this._notifyPresenceSub(e,u),()=>{var a,h,c;this._presence[e].handlers=(c=(h=(a=this._presence[e])===null||a===void 0?void 0:a.handlers)===null||h===void 0?void 0:h.filter(d=>d!==u))!==null&&c!==void 0?c:[],o()}}_notifyPresenceSubs(t){var e,r;(r=(e=this._presence[t])===null||e===void 0?void 0:e.handlers)===null||r===void 0||r.forEach(i=>{this._notifyPresenceSub(t,i)})}_notifyPresenceSub(t,e){const r=this.getPresence("",t,e);r&&(e.prev&&!si(r,e.prev)||(e.prev=r,e.cb(r)))}_setPresencePeers(t,e){const r=Object.assign({},e);delete r[this._sessionId];const i=Object.fromEntries(Object.entries(r).map(([o,u])=>[o,u.data]));this._presence[t]=this._presence[t]||{},this._presence[t].result=this._presence[t].result||{},this._presence[t].result.peers=i}publishTopic({roomType:t,roomId:e,topic:r,data:i}){this._trySendAuthed(Z(),{op:"client-broadcast","room-id":e,roomType:t,topic:r,data:i})}subscribeTopic(t,e,r){const i=this.joinRoom(t);return this._broadcastSubs[t]=this._broadcastSubs[t]||{},this._broadcastSubs[t][e]=this._broadcastSubs[t][e]||[],this._broadcastSubs[t][e].push(r),this._presence[t]=this._presence[t]||{},()=>{this._broadcastSubs[t][e]=this._broadcastSubs[t][e].filter(o=>o!==r),this._broadcastSubs[t][e].length||delete this._broadcastSubs[t][e],i()}}_notifyBroadcastSubs(t,e,r){var i,o,u;(u=(o=(i=this._broadcastSubs)===null||i===void 0?void 0:i[t])===null||o===void 0?void 0:o[e])===null||u===void 0||u.forEach(a=>{var h,c,d,_,U,L;const A=(h=r.data)===null||h===void 0?void 0:h.data,x=r.data["peer-id"]===this._sessionId?(d=(c=this._presence[t])===null||c===void 0?void 0:c.result)===null||d===void 0?void 0:d.user:(L=(U=(_=this._presence[t])===null||_===void 0?void 0:_.result)===null||U===void 0?void 0:U.peers)===null||L===void 0?void 0:L[r.data["peer-id"]];return a(A,x)})}upload(t,e){return X(this,void 0,void 0,function*(){var r;const i=yield this.getCurrentUser(),o=(r=i==null?void 0:i.user)===null||r===void 0?void 0:r.refresh_token,u=t||e.name,a=yield ei({apiURI:this.config.apiURI,appId:this.config.appId,fileName:u,refreshToken:o});return yield ni(a,e)})}getDownloadUrl(t){return X(this,void 0,void 0,function*(){var e;const r=yield this.getCurrentUser(),i=(e=r==null?void 0:r.user)===null||e===void 0?void 0:e.refresh_token;return yield ri({apiURI:this.config.apiURI,appId:this.config.appId,path:t,refreshToken:i})})}deleteFile(t){return X(this,void 0,void 0,function*(){var e;const r=yield this.getCurrentUser(),i=(e=r==null?void 0:r.user)===null||e===void 0?void 0:e.refresh_token;return yield ii({apiURI:this.config.apiURI,appId:this.config.appId,path:t,refreshToken:i})})}}let Nt;function vi(n){Nt==null||Nt.dispose();const t=mi(),e=wi(u),r=_i(bi(n));function i(c){var d;c.source===r.element.contentWindow&&((d=c.data)===null||d===void 0?void 0:d.type)==="close"&&t.isVisible()&&u()}function o(c){const d=c.shiftKey&&c.ctrlKey&&c.key==="0",_=c.key==="Escape"||c.key==="Esc";(d||_)&&u()}function u(){t.isVisible()?t.element.style.display="none":(t.element.style.display="block",t.element.contains(r.element)||t.element.appendChild(r.element))}function a(){t.element.remove(),e.element.remove(),removeEventListener("keydown",o),removeEventListener("message",i)}function h(){document.body.appendChild(t.element),document.body.appendChild(e.element),addEventListener("keydown",o),addEventListener("message",i),Nt={dispose:a}}return h()}function bi(n){return`${window.DEV_DEVTOOL?"http://localhost:3000":"https://instantdb.com"}/_devtool?appId=${n}`}function _i(n){const t=document.createElement("iframe");return t.src=n,Object.assign(t.style,{width:"100%",height:"100%",borderRadius:"4px",backgroundColor:"white",border:"none"}),{element:t}}function wi(n){const t=`
    <svg width="512" height="512" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="512" height="512" fill="black"/>
      <rect x="97.0973" y="91.3297" width="140" height="330" fill="white"/>
    </svg>
  `,e=document.createElement("button");return e.innerHTML=t,Object.assign(e.style,{position:"fixed",bottom:"24px",left:"24px",height:"32px",width:"32px",display:"flex",alignItems:"center",justifyContent:"center",padding:"0",margin:"0",border:"none",cursor:"pointer"}),e.addEventListener("click",n),{element:e}}function mi(){const n=document.createElement("div");Object.assign(n.style,{position:"fixed",bottom:"24px",right:"24px",left:"60px",top:"72px",display:"block",borderRadius:"4px",border:"1px #ccc solid",boxShadow:"0px 0px 8px #00000044",backgroundColor:"#eee",zIndex:"999990"}),n.style.display="none";function t(){return n.style.display!=="none"}return{element:n,isVisible:t}}const Si=!0,Ai={apiURI:"https://api.instantdb.com",websocketURI:"wss://api.instantdb.com/runtime/session"};function Oi(){var n;return globalThis.__instantDbStore=(n=globalThis.__instantDbStore)!==null&&n!==void 0?n:{},globalThis.__instantDbStore}const ce=Oi();function Ii(n,t,e){return Ei(n)}function Ei(n,t,e){const r=ce[n.appId];if(r)return r;const i=new yi(Object.assign(Object.assign({},Ai),n),hn,pn),o=new ji(i);return ce[n.appId]=o,typeof window<"u"&&typeof window.location<"u"&&("devtool"in n?n.devtool:Si)&&window.location.hostname==="localhost"&&!globalThis._nodevtool&&vi(n.appId),o}class ji{constructor(t){this.tx=on(),this._reactor=t,this.auth=new xi(this._reactor),this.storage=new ki(this._reactor)}transact(t){return this._reactor.pushTx(t)}getLocalId(t){return this._reactor.getLocalId(t)}subscribeQuery(t,e){return this._reactor.subscribeQuery(t,e)}subscribeAuth(t){return this._reactor.subscribeAuth(t)}joinRoom(t="_defaultRoomType",e="_defaultRoomId"){return{leaveRoom:this._reactor.joinRoom(e),subscribeTopic:(i,o)=>this._reactor.subscribeTopic(e,i,o),subscribePresence:(i,o)=>this._reactor.subscribePresence(t,e,i,o),publishTopic:(i,o)=>this._reactor.publishTopic({roomType:t,roomId:e,topic:i,data:o}),publishPresence:i=>this._reactor.publishPresence(t,e,i),getPresence:i=>this._reactor.getPresence(t,e,i)}}shutdown(){delete ce[this._reactor.config.appId],this._reactor.shutdown()}}class xi{constructor(t){this.db=t,this.sendMagicCode=e=>this.db.sendMagicCode(e),this.signInWithMagicCode=e=>this.db.signInWithMagicCode(e),this.signInWithToken=e=>this.db.signInWithCustomToken(e),this.createAuthorizationURL=e=>this.db.createAuthorizationURL(e),this.signInWithIdToken=e=>this.db.signInWithIdToken(e),this.exchangeOAuthCode=e=>this.db.exchangeCodeForToken(e),this.issuerURI=()=>this.db.issuerURI(),this.signOut=()=>this.db.signOut()}}class ki{constructor(t){this.db=t,this.upload=(e,r)=>this.db.upload(e,r),this.put=this.upload,this.getDownloadUrl=e=>this.db.getDownloadUrl(e),this.delete=e=>this.db.deleteFile(e)}}const Ui="bcc500de-07a9-4fde-9025-c87906e63bf3",Ci=Ii({appId:Ui});Ci.subscribeQuery({todos:{},blog:{}},n=>{if(n.error){Ti(n.error.message);return}n.data&&(Mi(n.data),console.log(n.data))});const fe=document.getElementById("app");function Mi(n){fe.innerHTML="",console.log(n);const{blog:t}=n;console.log(t);const{todos:e}=n;console.log(e);const r=`
    <main class="blog__page">
    <div class="blog__section_name">Stories</div>
      ${Pi(t)}
    </main>
  `;fe.innerHTML=r}function Ti(n){fe.innerHTML=`
    <div>${n}</div>
  `}function Pi(n){return`
    <section class="blog__section">
        ${n.map(t=>`
          <article class="blog__post">
            <h2 class="blog__header">${t.title}</h2>
            <h3 class="blog__subheader">${t.subtitle}</h3>
            <p class="blog__paragraph">${Li(t.content)}</p>
            <p class="blog__date">Date: ${t.postDate}</p>
          </article>
        `).join("")}
    </section>
  `}function Li(n){const t=n.split(" ");return t.length>20?t.slice(0,20).join(" ")+"...":n}
